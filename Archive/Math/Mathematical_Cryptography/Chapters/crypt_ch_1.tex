\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumi}{\theenumi.}
\section{Introduction}

\begin{note}
    Before starting the course, it is important to understand that this document is for note-taking, and will therefore be a bit more informal than the actual textbook. There may be missing sections in the chapters, and there will certainly be missing chapters when we finish for the semester. The textbook is \textit{An Introduction to Mathematical Cryptography} by Hoffstein, Pipher, and Silverman.
\end{note}

\wrpdef{Caesar Shift Cipher}{An encrypted text (by \textbf{shifting}), and you match it up with the alphabet. To encrypt, you write out a sentence, match it with a random assortment of letters by shifting the letters by a predetermined amount.}

\wrpdef{Code}{Replace words / concepts. Example: Eagle has landed.}

\wrpdef{Cipher}{Replacing characters or letters. Simply, replacing one letter for another.}

\wrpdef{Scytale Cipher}{Used by the Spartans in the \(5^{\text{th}}\) century B.C.. This is also known as a \textbf{Transposition Cipher}.}

\wrpdef{Transposition Cipher}{Changed order, but the stayed the same.}

\wrpdef{Plain Text}{Original message that is readable to humans. Abbreviated as [pt].}

\wrpdef{Cipher Text}{Encrypted message that is unreadable to humans. Abbreviated as [ct].}

\wrpdef{Encrypting}{From plain text to cipher text. The inverse of encrypting is decrypting; which is going from the Plain Text [pt] to the Cipher Text [ct].}

\wrpdef{Key}{A secret number or word used in encoding and decoding using a certain algorithm. Example: Caesar shift: \(A \rightarrow R\) rotated clockwise by 17}

\wrpdef{Key Space}{The set of all keys, notated \(\mathcal{K}\). The cardinality (amount of different keys) is notated with absolute value symbols. (E.g., for the Caesar shift, \(|\mathcal{K}| = 26\) because there are 26 letters in the alphabet. Similarly, Scytale \(|\mathcal{K}| = \text{pt}\).)}

\wrpdef{Brute Force Attack}{[During decryption] Trying all possible keys.}

\subsection{Goals of Cryptography}

\begin{enumerate}
    \item Provide confidentiality -- You can't read the message.
    \item Provide integrity -- You can't change the message.
    \item Provide authenticity -- You can't forge the message.
\end{enumerate}

Generally, these are the people and setting that will be used in examples: Alice and Bob are trying to communicate. Eve is trying to eavesdrop on the conversation. \\

\subsection{Simple Substitution Ciphers (Mono-alphabetic Cipher)}

Each letter can be replaced with any other letter. For example, you may have a key: \(\{a,b,c,\dots,z\} \rightarrow \{q,m,w,\dots,t\}\). Its cardinality is \(|\mathcal{K}| = 26!\). \\

\wrpdef{Cryptanalysis}{Process of decrypting without a key.}

\newpage

\wrpdef{Bigrams}{Two letters that are commonly placed together in language. For example, ``Th'', ``is'', or ``He''.}

\wrpdef{Frequency Analysis}{English language patterns. Note that \(13\%\) of letters that are used in the alphabet are (in order from greatest to least): E, T, A, O, N. In brief, the longer the text, the more likely these letters will pop up.} 

\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand{\labelenumi}{(\theenumi)}
\subsection{Exercises}

\begin{exercise}
    {1.1}Build a cipher wheel as illustrated in Figure 1.1, but with an inner wheel that rotates, and use it to complete the following tasks.
    \begin{enumerate}
        \item Encrypt the following plaintext using a rotation of 11 clockwise.
              \begin{center}
                  ``A page of history is worth a volume of logic.''
              \end{center}
        \item Decrypt the following message, which was encrypted with a rotation of 7 clockwise.
              \begin{center}
                  \texttt{AOLYLHYLUVZLJYLAZILAALYAOHUAOLZLJYLALZAOHALCLYFIVKFNBLZZLZ}
              \end{center}
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item \texttt{L ALRP ZQ STDEZCJ TD HZCES L GZWFXP ZQ WZRTN}
        \item THERE ARE NO SECRETS BETTER THAN THE SECRETES [sic] THAT EVERY BODY GUESSES \\
              In the encrypted text, ``Secrets'' is \texttt{ZLJYLAZ}. Then, they use an incorrect spelling of the word, \texttt{ZLJYLALZ}, of which has an extra `e' in it. That is what the ``[sic]'' is for.
    \end{enumerate}
}

\newpage
\vfill

\begin{exercise}
    {1.2}Decrypt each of the following Caesar encryptions by trying the various possible
    shifts until you obtain readable text.
    \begin{enumerate}
        \item \texttt{LWKLQNWKDWLVKDOOQHYHUVHHDELOOERDUGORYHOBDVDWUHH}
        \item \texttt{UXENRBWXCUXENFQRLQJUCNABFQNWRCJUCNAJCRXWORWMB}
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item I THINK THAT I SHALL NEVER SEE A BILLBOARD LOVELY AS A TREE
        \item LOVE IS NOT LOVE WHICH ALTERS WHEN IT ALTERATION FINDS
    \end{enumerate}
}
\vfill


\begin{exercise}
    {1.3}For this exercise, use the simple substitution table given in Table 1.11.
    \begin{enumerate}
        \item Encrypt the plaintext message:
              \center{The gold is hidden in the garden}
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item \texttt{IBX FEPA QL BQAAXW QW IBX FSVAXW}
    \end{enumerate}
}
\vfill
\newpage

\begin{exercise}
    {1.4} Each of the following messages has been encrypted using a simple substitution cipher. Decrypt them. For your convenience, we have given you a frequency table and a list of the most common bigrams that appear in the ciphertext.\ (If you do not want to recopy the ciphertexts by hand, they can be downloaded or printed from the web site listed in the preface.)
    \begin{enumerate}
        \item “A Piratical Treasure”
              \begin{flushleft}
                  \texttt{JNRZR BNIGI BJRGZ IZLQR OTDNJ GRIHT USDKR ZZWLG OIBTM NRGJN} \\
                  \texttt{IJTZJ LZISJ NRSBL QVRSI ORIQT QDEKJ JNRQW GLOFN IJTZX QLFQL} \\
                  \texttt{WBIMJ ITQXT HHTBL KUHQL JZKMM LZRNT OBIMI EURLW BLQZJ GKBJT} \\
                  \texttt{QDIQS LWJNR OLGRI EZJGK ZRBGS MJLDG IMNZT OIHRK MOSOT QHIJL} \\
                  \texttt{QBRJN IJJNT ZFIZL WIZTO MURZM RBTRZ ZKBNN LFRVR GIZFL KUHIM} \\
                  \texttt{MRIGJ LJNRB GKHRT QJRUU RBJLW JNRZI TULGI EZLUK JRUST QZLUK} \\
                  \texttt{EURFT JNLKJ JNRXR S}
              \end{flushleft}
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item THESE CHARACTERS AS ONE MIGHT READILY GUESS FORM A CIPHER THAT IS TO SAY THEY CONVEY A MEANING BUT THEN FROM WHAT IS KNOWN OF CAPTAIN KIDD I COULD NOT SUPPOSE HIM CAPABLE OF CONSTRUCTING ANY OF THE MORE ABSTRUSE CRYPTOGRAPHS I MADE UP MY MIND AT ONCE THAT THIS WAS OF A SIMPLE SPECIES SUCH HOW EVER AS WOULD APPEAR TO THE CRUDE INTELLECT OF THE SAILOR ABSOLUTELY INSOLUBLE WITHOUT THE KEY
    \end{enumerate}
    \href{https://planetcalc.com/8047/}{Solver}.

}
\newpage

\begin{exercise}
    {1.5}Suppose that you have an alphabet of 26 letters.
    \begin{enumerate}
        \item How many possible simple substitution ciphers are there?
        \item A letter in the alphabet is said to be fixed if the encryption of the letter is the letter itself. \textit{Show an example of how the pieces work together}
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item \(26!\)
        \item This is the formula used for solving for derangements (where \(n\) is the number of elements in the set, and \(!n\) is the number of derangements [Definition: A permutation with no fixed points]): \(!n=n!\sum_{i=0}^{n}{\frac{(-1)^{i}}{i!}}\). From \href{https://en.wikipedia.org/wiki/Derangement}{Wikipedia}. For \(n = 2\). We can run through the following:
              \begin{enumerate}[label=(\arabic*)]
                  \item \(i = 0\): \(\frac{(-1)^0}{0!} = 1\)
                  \item \(i = 1\): \(\frac{(-1)^1}{1!} = -1\)
                  \item \(i = 2\): \(\frac{(-1)^2}{2!} = 0.5\)
              \end{enumerate}
              Sum them together: \(1 - 1 + 0.5 = 0.5\). Now we can get \(!2\): \[!2 = 2! \times (1 - 1 + 0.5) = 2 \times 0.5 = 1\]
    \end{enumerate}
}

\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumi}{\theenumi.}
\section{Divisibility and Greatest Common Denominators}

Can assume all the properties of \(\R, \Z, \text{ and } \N\). Note that \(\N\) does not include 0. \\

\wrpdef{Divides}{Let \(a\) and \(b\) be integers with \(b \ne 0\). We say that \(b \textit{ divides } a\) or that \(a \) is divisible by \(b\), denoted by \(b \mid a\), if there exists an integer \(n\) such that \(a = nb\).}

\begin{example}
    {Divisibility}Let \(a = 100\) and \(b = 4\). Is \(b \mid a\)?
\end{example}

\lesol{
    Yes, because \(100 = 4 \times 25\).
}

\begin{example}
    {Divisibility}Let \(a = 100\) and \(b = 8\). Is \(b \mid a\)?
\end{example}

\lesol{
    No, because \(100 = 8 \times 12 + 4\).
}

\wrpprop{1.4}{Let \(a,b,c \in \Z\):
    \begin{enumerate}
        \item If \(a \mid b\) and \(b \mid c\), then \(a \mid c\).
        \item If \(a \mid b\) and \(b \mid a\), then \(a = \pm 2\).
        \item If \(a \mid b\) and \(a \mid c\), then \(a \mid (b + c) \text{ and } a \mid (b - c)\).
    \end{enumerate}}


\wrpdef{Greatest Common Divisor}{A \textit{common divisor} of two integers \(a\) and \(b\) is a positive integer \(d\) that divides both of them. The \textit{greatest common divisor} of \(a\) and \(b\), denoted by \(\gcd(a,b)\), is the largest positive integer such that \(d \mid a \) and \(d \mid b\).} \\

This is less complicated than it sounds: we are simply factoring the integers and finding the largest common divisor between the two numbers. \\

\wrpdef{Divison with Remainder}{Let \(a,b\) be positive integers. Then we say that \(a\) \textit{divided by} \(b\) gives a \textit{quotient} \(q\) and a \textit{remainder} \(r\) if \(a = bq + r\) and \(0 \leq r < b\).} \\

\begin{example}
    {Division with Remainder}Let \(a = 24\) and \(b = 16\). Find the quotient and remainder.
\end{example}
\lesol{
    \(24 = 16(1) + 8\). Therefore, the quotient is 1 and the remainder is 8.
}
\newpage
\begin{theorem}
    {Euclidean Algorithm}Let \(a,b \in \Z^+\) with \(a \geq b\). The following algorithm computes \(\gcd(a,b)\) in a finite number of steps. \begin{enumerate}
        \item Let \(r_0 = a, r_1 = b\);
        \item Set \(i = 1\);
        \item Divide \(r_{i - 1}\) by \(r_i\) to get quotient \(q_i\) and remainder \(r_{i + 1}\);
        \item If \(r_{i + 1} = 0\), stop, and \(\gcd(a,b) = r_i\);
        \item Otherwise, \(r_{i + 1} > 0\). Set \(i = i + 1\), and go back to step 3.
        \item Step 3 is executed at most \(2\log_2(b) + 2\) times.
    \end{enumerate}
\end{theorem}


% \begin{theorem}
%     {}Let \(a,b \in \Z^+\) with \(a = bq + r\), \(0 \leq r < b\). Then, \(\gcd(a,b) = \gcd(b,r)\)
% \end{theorem}

% \tpf{
%     Let \(d = \gcd(a,b) \Rightarrow d \mid a \text{ and } d \mid b \Rightarrow a = dk \text{ and } b = dl \text{ for some } k,l \in \Z\). We need to show \(d \mid b\) and \(d \mid r\). We already have \(d \mid b\), so we just need to solve for \(r\): \begin{align*}
%         r & = a - bq    \\
%           & = dk - dlq  \\
%           & = d(k - lq)
%     \end{align*} Notice that \((k - lq) \in \Z\). However, we also need to prove that \(d\) is the largest factor that Divides both. Hence, assume there exists a \(D \in \Z^+\) such that \(D\mid b\), \(D \mid r\), and \(D > d\). Then, \(D \times m = b\) and \(D \times n = r \Rightarrow a = D(mq) + D(n) \Rightarrow D \mid a\), but this leads to a contradiction because we said that \(d\) was the Greatest Common Divisor of \(a\). Hence, \(D = d\).
% }

% Example: \(150 = 4(36) + 6\) (Def 1.1.3) \(\Rightarrow \gcd(150,36) = \gcd(36,6) \Rightarrow 36 = 6(6) + 0 \Rightarrow \gcd(36,6) = \gcd(6,0) = 6\). \\
\vfill
\begin{example}
    {Euclidean Algorithm} Compute \(\gcd(2024, 748)\) using the Euclidean Algorithm.
\end{example}

\lesol{
    Notice how the \(b\) and \(r\) values on each line become the new \(a\) and \(b\) values on the subsequent line:
    \begin{align*}
        2024 & = 2(748) + 528       \\
        748  & = 1(528) + 220       \\
        528  & = 2(220) + 88        \\
        220  & = 2(88) + \boxed{44} \\
        88   & = 2(44) + 0
    \end{align*}
    Therefore, the greatest common divisor is 44.
}
\vfill

\newpage

\begin{example}
    {Linear Combinations}Use Example 1.2 in determining the linear combination of 2024 and 748 that equals 44.
\end{example}

\lesol{
    We let \(a = 2024\) and \(b = 748\). From the equation in Example 1.2, we read the first line:
    \[
        528 = a - 2b.
    \]
    We substitue this into the second line to get
    \[
        b = (a - 2b) \cdot 1 + 220, \quad \text{ so } \quad 220 = 2b - a.
    \]
    We next substitute the expressions \(528 = a - 2b\) and \(220 = 2b - a\) into the third line to get
    \[
        a - 2b = (-a + 3b) \cdot 2 + 88, \quad \text{ so } \quad 88 = 3a - 8b.
    \]
    Finally, we substitute the expressions \(220 = -a + 3b\) and \(88 = 3a - 8b\) into the fourth line to get
    \[
        -a + 3b = (3a - 8b) \cdot 2 + 44, \quad \text{ so } \quad 44 = 7a - 19b.
    \]
    In other words,
    \[
        -7 \cdot 2024 + 19 \cdot 748 = 44 = \gcd(2024, 748),
    \]
    so we have found a way to write \(\gcd(a, b)\) as a linear combination of \(a\) and \(b\) using integer coefficients. \\
}

\wrpdef{Relatively Prime}{Let \(a\) and \(b\) be \textit{relatively prime} if \(\gcd(a,b) = 1\). More generally, any equation \(Au + Bv = \gcd(A,B)\) can be reduced to the case of relatively prime numbers by dividing both sides by \(\gcd(A,B)\). Thus, \(\frac{A}{\gcd(A,B)}u + \frac{B}{\gcd(A,B)} = 1\) where \(a = A / \gcd(A,B)\) and \(b = B / \gcd(A,B)\) are relatively prime and satisfy \(au + bv = 1\).}

\begin{theorem}
    {Extended Euclidean Algorithm}Let \(a,b \in \Z^+\) with \(a \geq b\). Then the equation \(\gcd(a,b) = ua + vb\) always has a solution in integers \(u\) and \(v\). If \(u_0,v_0\) is any one solution, then every solution has the form 
    \[
        u = u_0 + \frac{b \cdot t}{\gcd(a,b)} \quad \text{and} \quad v = v_0 - \frac{a \cdot t}{\gcd(a,b)}, \text{ for some integer } t \in \Z.
    \]
\end{theorem}

\begin{example}
    {Inverse Modulo Application with EEA}Solve for \(d\) using the extended Euclidean algorithm:
    \[
        d \cdot 137 \equiv 1 \pmod{540} \quad \Rightarrow \quad d \equiv 137^{-1} \pmod{540}
    \]
\end{example}

\begin{center}
    \begin{tabular}{ccccccc}
        \(n\) & \(b\) & \(q\) & \(r\) & \(t_1\) & \(t_2\) & \(t_3\)         \\ \toprule
        540   & 137   & 3     & 129   & 0       & 1       & \(-3\)          \\ \midrule
        137   & 129   & 1     & 8     & 1       & \(-3\)  & 4               \\ \midrule
        129   & 8     & 16    & 1     & \(-3\)  & 4       & \(\boxed{-67}\) \\ \midrule
        8     & 1     & 8     & 0     &         &         &                 \\ \midrule
    \end{tabular}
\end{center} A step by tep break down for how this table got its values:
\begin{enumerate}[label=\arabic*.]
    \item \textbf{Initial Setup}

          Start with \(t_1 = 0\) and \(t_2 = 1\). Calculate \(t_3\) with the recursive formula \(t_3 = t_1 - q \cdot t_2\) where \(q\) is the quotient from the division of the 2 numbers (\(n\) divided by \(b\)), and the \(t\) values shift as you move to the next row.

    \item \textbf{Calculate \(t_3\) Values}

          \textit{First row:}
          \begin{itemize}
              \item We start with \(n = 540\) and \(b = 137\).
              \item The quotient \(q = \lfloor \frac{540}{137} \rfloor = 3\).
              \item The values of \(t_1 = 0\) and \(t_2 = 1\) are given by default.
              \item Now, calculate the \(t_3\) using the formula
                    \[
                        t_3 = t_1 - q \cdot t_2 = 0 - 3 \cdot 1 = -3
                    \]
              \item This leaves us with \(t_2 = 1, \ t_3 = -3\). These will become \(t_1\) and \(t_2\) in the next row.
          \end{itemize}
          \textit{Second row:}
          \begin{itemize}
              \item Now, \(n = 137\) and \(b = 129\). We get \(b\) by solving \(b = n - b \cdot q \Rightarrow b = 540 - 137 \cdot 3 = 129\).
              \item The quotient \(q = \lfloor \frac{137}{129} \rfloor = 1\).
              \item The values of \(t_1 = 1\) and \(t_2 = -3\) from the previous row.
              \item Now, calculate the \(t_3\) using the formula
                    \[
                        t_3 = t_1 - q \cdot t_2 = 1 - 1 \cdot -3 = 4
                    \]
              \item This leaves us with \(t_2 = -3, \ t_3 = 4\). These will become \(t_1\) and \(t_2\) in the next row.
          \end{itemize}
          \textit{Third row:}
          \begin{itemize}
              \item Now, \(n = 129\) and \(b = 8\).
              \item The quotient \(q = \lfloor \frac{128}{8} \rfloor = 16\).
              \item The values of \(t_1 = -3\) and \(t_2 = 4\) from the previous row.
              \item Now, calculate the \(t_3\) using the formula
                    \[
                        t_3 = t_1 - q \cdot t_2 = -3 - 16 \cdot 4 = -67
                    \]
          \end{itemize}
          \textit{Fourth row:}
    \item Now, \(n = 8\) and \(b = 1\).
    \item The quotient \(q = \lfloor \frac{8}{1} \rfloor = 8\).
    \item Because get a remainder of 0 from the previous calculation, we stop, and record the largest \(t\) value.
\end{enumerate}
Now we have our \(t = -67\), but we still need to find the modulo. Take the modulo of \(t\) (\(-67 \pmod{540} = 473\)), and you get the inverse, 473.

\textbf{See Exercise~\hyperref[exerc:1.10]{1.10} for a detailed example.}

\begin{example}
    {Relative Prime}What are the relative prime numbers of 2024 and 748?
\end{example}

\lesol{
    In Example 1.2, we found that the gcd of 2024 and 748 have greatest common divisor of 44 and satisfy the equation \(-7 \cdot 2024 + 19 \cdot 748 = 44\). We can divide both sides by 44 to get \(46u + 17v = 1\). Therefore, 46 and 17 are relatively prime and \(u = -7\) and \(v = 19\) are the coefficients of a linear combination of 46 and 17 that equals 1.
}

\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand{\labelenumi}{(\theenumi)}
\subsection{Exercises}
\begin{exercise}
    {1.6}Let \(a, b, c \in Z\). Use the definition of divisibility to directly prove the following properties of divisibility.\ (This is \refprop{1.4})
    \begin{enumerate}
        \item If \(a \mid b\) and \(b \mid c\). Then \(a \mid c\).
        \item If \(a \mid b\) and \(b \mid a\). Then \(a = \pm b\).
        \item If \(a \mid b\) and \(a \mid c\). Then \(a \mid (b + c)\) and \(a \mid (b - c)\).
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item Let \(a,b,c \in \Z\) such that \(a \mid b\) and \(b \mid c\). We know there exists an \(n \in \Z\) such that \(a \times n = b\). Similarly, \(b \mid c\) means there exists an \(k \in \Z\) such that \(b\times k = c\). We can use the commutative property to show that:
              \begin{align*}
                  k(an) & = (b)k \\
                  ank   & = bk   \\
                  bk    & = c    \\
                  a(nk) & = c    \\
                  a     & \mid c
              \end{align*}
        \item From the problem statement, we can intuitively ascertain that because both \(a,b\) divide each other, then it must be the case that they are the same number. Moreover, because the criteria for dividing is not pertinent to whether the quotient is negative or positive, this number can be positive or negative. Now that we have an idea of what we are trying to accomplish, we can begin the proof: Let \(a,b \in \Z\) such that \(a \mid b\) and \(b \mid a\). We know there exists an \(n \in \Z\) such that \(a \times n = b\). Similarly, \(b \mid a\) means there exists an \(k \in \Z\) such that \(b\times k = a\). Then, we can utilize substitution to get the following:
              \begin{align*}
                  bk    & = a \\
                  (an)k & = a
              \end{align*} From here, we know that because \(a\) is present on both sides of the equation, we should divide by \(a\) to simplify. Thus, consider the following two cases.
              \begin{itemize}
                  \item \textbf{Case 1:} \(a \ne 0\) \\
                        Since \(a\) is not zero, we can divide both sides by \(a\) to get \(nk = 1\). Since, \(n,k \in \Z\). We do not need to worry about fractional reciprocals. Instead, we know from the identity property of multiplication, that \(n,k\) must both be \(\pm 1\).\ \begin{itemize}
                            \item \textbf{\(n,k\) are both \(+1\):} Then, \(a = b \times 1 \text{ and } b = a \times 1\). Which simplifies to \(a = b\) in both cases.
                            \item \textbf{\(n,k\) are both \(-1\):} Then, \(a = b \times (-1) \text{ and } b = a \times (-1)\) Which simplifies to \(a = -b\) in both cases.
                        \end{itemize}
                  \item \textbf{Case 2:} \(a = 0\) \\
                        If \(a = 0\). Then \(b = 0 \times n = 0\) and \(0 = b \times k = 0\). Therefore, \(a = b = 0\). And \(a = \pm b\) is still true.
              \end{itemize}
              We have shown that in either case if \(a \mid b\) and \(b \mid a\). Then \(a = \pm b\).
        \item Because \(a\) needs to be divisible by both \(b\) and \(c\). We know that there must exist an \(n,k \in \Z\) such that \(b = an\) and \(c = ak\). Our goal is to get to the form, \(a \times \text{ some integer } = b + c\) and \(a \times \text{ some integer } = b - c\) so we can use the definition of divides to help us out here. Therefore, let us consider both \(b + c\) and \(b - c\) in two separate cases:
              \begin{itemize}
                  \item \textbf{Case 1:} \(b + c\)
                        \begin{align*}
                            b + c & = (an) + (ak) \\
                            b + c & = a(n + k)    \\
                            a     & \mid (b + c)
                        \end{align*}
                  \item \textbf{Case 2:} \(b - c\)
                        \begin{align*}
                            b - c & = (an) - (ak) \\
                            b - c & = a(n - k)    \\
                            a     & \mid (b - c)
                        \end{align*}
              \end{itemize}
              We have shown that if \(a \mid b\) and \(a \mid c\). Then \(a \mid (b + c)\) and \(a \mid (b - c)\).
    \end{enumerate}
}

\begin{exercise}
    {1.7}Use a calculator and the method described in Remark 1.9 to compute the following quotients and remainders.
    \begin{enumerate}
        \item 34787 divided by 353.
        \item 238792 divided by 7843.
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item \(a = 34787\) and \(b = 353\). Then \(a / b \approx 98.54674220\). So \(q = 98\) and \(r = a - b \cdot q = 34787 - 353 \cdot 98 = 193\).
        \item \(a = 238792\) and \(b = 7843\). Then \(a / b \approx 30.446512\). So \(q = 30\) and \(r = a - b \cdot q = 238792 - 7843 \cdot 30 = 3502\).
    \end{enumerate}
}

\begin{exercise}
    {1.9}Use the Euclidean algorithm to compute the following greatest common divisors.
    \begin{enumerate}
        \item \(\gcd(291, 252)\).
        \item \(\gcd(16261, 85652)\).
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item \(\gcd(291,252)\)
              \begin{enumerate}[label=(\arabic*)]
                  \item \(r_0 = 291\).\ \(r_1 = 252\).
                  \item \(i = 1\).
                  \item Divide \(r_0\) by \(r_1\) to get a quotient, \(q_1\) and a remainder, \(r_{2}\):
                        \begin{align*}
                            291 / 252            & = 1 = q_1  \\
                            291 - (252 \times 1) & = 39 = r_2
                        \end{align*}
                  \item \(r_2 \ne 0\). So, we continue.
                  \item \(i = 2 + 1 = 3\).
              \end{enumerate}
              \pfs
              \begin{enumerate}[label=(\arabic*)]
                  \setcounter{enumii}{2}
                  \item Divide \(r_1\) by \(r_2\) to get quotient, \(q_2\) and a remainder, \(r_3\):
                        \begin{align*}
                            252 / 39            & = 6 = q_2  \\
                            252 - (39 \times 6) & = 18 = r_3
                        \end{align*}
                  \item \(r_3 \ne 0\). So, we continue.
                  \item \(i = 3 + 1 = 4\).
              \end{enumerate}
              \pfs
              \begin{enumerate}[label=(\arabic*)]
                  \setcounter{enumii}{2}
                  \item Divide \(r_2\) by \(r_3\) to get quotient \(q_3\) and a remainder, \(r_4\):
                        \begin{align*}
                            39 / 18            & = 2 = q_3 \\
                            39 - (18 \times 2) & = 3 = r_4
                        \end{align*}
                  \item \(r_4 \ne 0\). So, we continue.
                  \item \(i = 3 + 1 = 5\).
              \end{enumerate}
              \pfs
              \begin{enumerate}[label=(\arabic*)]
                  \setcounter{enumii}{2}
                  \item Divide \(r_3\) by \(r_4\) to get quotient \(q_4\) and a remainder, \(r_5\):
                        \begin{align*}
                            18 / 3            & = 6 = q_4 \\
                            18 - (3 \times 6) & = 0 = r_5
                        \end{align*}
                  \item \(r_4 = 0\). So, we stop.
              \end{enumerate}
              We have found that the greatest common divisor is \(3\).
        \item \textit{To cut back on paper, I am going to avoid reiterating the steps of 4 and 5. If there is a continuation in the enumeration process, then \(r_i \ne 0\). And the process needs to continue}: \(\gcd(16261,85652) \Rightarrow \gcd(85652,16261)\).
              \begin{enumerate}[label=(\arabic*)]
                  \item
                        \begin{align*}
                            85652 / 16261            & = 5 = q_1    \\
                            85652 - (16261 \times 5) & = 4347 = r_2
                        \end{align*}
                  \item
                        \begin{align*}
                            16261 / 4347            & = 3 = q_2    \\
                            16261 - (4347 \times 3) & = 3220 = r_3
                        \end{align*}
                  \item
                        \begin{align*}
                            4347 / 3220            & = 1 = q_3    \\
                            4347 - (3220 \times 1) & = 1127 = r_4
                        \end{align*}
                  \item
                        \begin{align*}
                            3220 / 1127            & = 2 = q_4   \\
                            3220 - (1127 \times 2) & = 966 = r_5
                        \end{align*}
                  \item
                        \begin{align*}
                            1127 / 966            & = 1 = q_5   \\
                            1127 - (966 \times 1) & = 161 = r_6
                        \end{align*}
                  \item
                        \begin{align*}
                            966 / 161            & = 6 = q_6 \\
                            966 - (161 \times 6) & = 0 = r_7
                        \end{align*}
              \end{enumerate}
              We have found that \(\gcd(85652,16261) = 161\).

    \end{enumerate}
}

\begin{exercise}
    {1.10} For each of the \(\gcd(a, b)\) values in Exercise 1.9, use the extended Euclidean
    algorithm (Theorem 1.11) to find integers \(u\) and \(v\) such that \(au + bv = \gcd(a, b)\).
\end{exercise}

\sol{
    \begin{enumerate}
        \item We need to solve for the various \(u_i\) and \(v_i\). We will start at \(i = 2\).\ \\
              \begin{tabular}{c|c|c|c|c|c|c}
                  \(i\)      & \(u_i\) & \textit{Formula}         & \textit{Evaluation}   & \(v_i\) & \textit{Formula}         & \textit{Evaluation}   \\ \hline
                  \textit{2} & \(1\)   & \(u_0 - q_1 \times u_1\) & \(1 - 1 \times 0\)    & \(-1\)  & \(v_0 - q_1 \times v_1\) & \(0 - 1 \times 1\)    \\ \hline
                  \textit{3} & \(-6\)  & \(u_1 - q_2 \times u_2\) & \(0 - 6 \times 1\)    & \(7\)   & \(v_1 - q_2 \times v_2\) & \(1 - 6 \times (-1)\) \\ \hline
                  \textit{4} & \(13\)  & \(u_2 - q_3 \times u_3\) & \(1 - 2 \times (-6)\) & \(-15\) & \(v_2 - q_3 \times v_3\) & \(-1 - 2 \times 7\)   \\
              \end{tabular} \\

              \pfs

              Thus, we can now fill out the table in full:
              \begin{tabular}{c|c|c|c|c|c}
                  \textit{i} & \textit{\(r_i\)} & \textit{\(q_i\)} & \(r_{i + 1}\) & \textit{\(u_i\)} & \textit{\(v_i\)} \\ \hline
                  \textit{0} & \(291\)          & \(-\)            & \(-\)         & \(1\)            & \(0\)            \\ \hline
                  \textit{1} & \(252\)          & \(1\)            & \(39\)        & \(0\)            & \(1\)            \\ \hline
                  \textit{2} & \(39\)           & \(6\)            & \(18\)        & \(1\)            & \(-1\)           \\ \hline
                  \textit{3} & \(18\)           & \(2\)            & \(3\)         & \(-6\)           & \(7\)            \\ \hline
                  \textit{4} & \(3\)            & \(6\)            & \(0\)         & \(13\)           & \(-15\)          \\
              \end{tabular} \\

              Now, we need to solve: \(au + bv = \gcd(a,b) \Rightarrow 291(13) + 252(-15) = 3\).\ \(3\) matches the gcd that we found in Exercise 1.9, so this is the correct solution.

        \item

              \begin{tabular}{c|c|c|c|c|c}
                  \textit{i} & \textit{\(r_i\)} & \textit{\(q_i\)} & \(r_{i + 1}\) & \textit{\(u_i\)} & \textit{\(v_i\)} \\ \hline
                  \textit{0} & \(85652\)        & \(-\)            & \(-\)         & \(1\)            & \(0\)            \\ \hline
                  \textit{1} & \(16261\)        & \(5\)            & \(4347\)      & \(0\)            & \(1\)            \\ \hline
                  \textit{2} & \(4347\)         & \(3\)            & \(3220\)      & \(1\)            & \(-5\)           \\ \hline
                  \textit{3} & \(3220\)         & \(1\)            & \(1127\)      & \(-3\)           & \(16\)           \\ \hline
                  \textit{4} & \(1127\)         & \(2\)            & \(966\)       & \(4\)            & \(-21\)          \\ \hline
                  \textit{5} & \(966\)          & \(1\)            & \(161\)       & \(-11\)          & \(58\)           \\ \hline
                  \textit{6} & \(161\)          & \(6\)            & \(0\)         & \(15\)           & \(-79\)          \\
              \end{tabular} \\

              \(85652(15) + 16261(-79) = 161\).
    \end{enumerate}
}

\begin{exercise}
    {1.11} Let \(a\) and \(b\) be positive integers.
    \begin{enumerate}
        \item Suppose that there are integers \(u\) and \(v\) satisfying \(au + bv = 1\). Prove that \(\gcd(a, b) = 1\).
    \end{enumerate}
\end{exercise}

\expf{
    \begin{enumerate}
        \item Suppose there are integers \(a,b,u,v\) such that \(av + bv = 1\). Assume \(d \in \Z\) such that \(d = \gcd(a,b)\). Since \(d\) divides both \(a\) and \(b\) by definition of common divisor, it must also divide \(av\) and \(bv\) by definition of divisibility. Moreover, because \(au + bv = 1\) and \(d\) is a common divisor of both \(av\) and \(bv\). It must also divide \(1\) by Proposition 1.4 (c). Then, the only positive integer that divides \(1\) is \(1\) itself, so it must be the case that \(d = 1\). Therefore, since \(d = 1\) and \(\gcd(a,b) = d\). It follows that \(\gcd(a,b) = 1\).\ \qedhere
    \end{enumerate}
}

\begin{exercise}
    {1.14}Let \(m \geq 1\) be an integer and suppose that \[a_1 \equiv a_2 \ (\text{mod } m) \text{ and } b_1 \equiv b_2 \ (\text{mod } m).\]Prove that \[a_1 \pm b_1 \equiv a_2 \pm b_2 \ (\text{mod } m) \text{ and } a_1 \cdot b_1 \equiv a_2 \cdot b_2 \ (\text{mod } m).\](This is Proposition 1.13(a).)
\end{exercise}

\expf{
    Let \(m \geq 1\) be an integer and suppose that \(a_1 \equiv a_2 \ (\text{mod } m) \text{ and } b_1 \equiv b_2 \ (\text{mod } m)\). From the definition of modulo, we know the difference of \(a_1 - a_2\) and \(b_1 - b_2\) is divisible by \(m\).
    \begin{itemize}
        \item \textbf{Addition:} We want to show that \(a_1 + b_1 \equiv a_2 + b_2\). So, our goal is to achieve \(m \mid ((a_1 + b_1) - (a_2 + b_2))\). Thus, consider \((a_1 + b_1) - (a_2 + b_2)\). We can distribute the minus sign to get \((a_1 - a_2) + (b_1 - b_2)\). From Proposition 1.4 (c), because we know that \(m \mid (a_1 - a_2)\) and \(m \mid (b_1 - b_2)\). We can write this as \(m \mid ((a_1 - a_2) + (b_1 - b_2))\) which implies \(m \mid ((a_1 + b_1) - (a_2 + b_2))\). This shows \(a_1 + b_1 \equiv a_2 + b_2 \ (\text{mod } m)\).
        \item \textbf{Subtraction:} Similarly to addition, we want to show \(a_1 - b_1 \equiv a_2 - b_2 \ (\text{mod } m)\). Thus, consider \((a_1 - b_1) - (a_2 - b_2)\) which implies \( (a_1 - a_2) - (b_1 - b_2)\). From Proposition 1.4 (c), because we know that \(m \mid (a_1 - a_2)\) and \(m \mid (b_1 - b_2)\). We can write this as \(m \mid ((a_1 - a_2) - (b_1 - b_2))\) which implies \(m \mid ((a_1 - b_1) - (a_2 - b_2))\). So \(a_1 - b_1 \equiv a_2 - b_2 \ (\text{mod } m)\).
    \end{itemize}
    Therefore we have shown \(a_1 \pm b_1 \equiv a_2 \pm b_2 \ (\text{mod } m)\)
    \begin{itemize}
        \item \textbf{Product} We want to show that \(a_1 \cdot a_2 \equiv a_2 \cdot b_2 \ (\text{mod } m)\). Thus, consider \(a_1 \cdot b_1 - a_2 \cdot b_2\):
              \begin{align*}
                  a_1 \cdot b_1 - a_2 \cdot b_2 & = a_1 \cdot b_1 - a_1 \cdot b_2 + a_1 \cdot b_2 - a_2 \cdot b_2 \\
                                                & = a_1 \cdot (b_1 - b_2) + b_2 \cdot (a_1 - a_2)
              \end{align*}
              Because \(m \mid (b_1 - b_2)\) and \(m \mid (a_1 - a_2)\). We know from the definition of division that when we multiply those numbers by an integer like \(a_1\) and \(b_2\).\ \(m\) still divides the expression. Hence, \(m \mid (a_1 \cdot (b_1 - b_2))\) and \(m \mid (b_2 \cdot (a_1 - a_2))\). Therefore, \(m \mid (a_1 \cdot b_1 - a_2 \cdot b_2)\) and \(a_1 \cdot b_1 \equiv a_2 \cdot b_2 \ (\text{mod } m)\).\ \qedhere
    \end{itemize}
}
\newpage

\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumi}{\theenumi.}
\section{Modular Arithmetic}

\wrpdef{Modular Arithmetic}{Let \(m \geq 1\) be an integer. We say that the integers \(a\) and \(b\) are congruent modulo \(m\) if their difference is divisible by \(m\): \(m \mid (b - a)\) or \(m \mid (a - b)\). Notated as \(a = b\bmod m\)}

By the definition of division, we can write this as \(b - a = mk\) for some \(k \in \Z\) and \(b = mk + a\) for some \(k \in \Z\). For example, \(17\bmod 4 \equiv 1\). Or for another example, \(-17\bmod 4 \equiv -1 \equiv 3\). In addition, you can go in two separate directions. For the first, sequence of operations, we could add the numbers inside the parentheses and then take the mod of the number as demonstrated \((26 + 14)\bmod 5 \equiv 40 \bmod 5 \equiv 0\), or we could take the mod of both numbers inside the parentheses, demonstrated as \(26\bmod + 14\bmod 5 = 1 + 4 = 0\). \\

\wrpprop{1.13}{Let \(m \in \Z^+\)
    \begin{enumerate}
        \item If \(a_1 \equiv a_2 \ (\text{mod } m)\) and \(b_1 \equiv b_2 \ (\text{mod } m)\) then \(a_1 \pm b_1 \equiv a_2 \pm b_2 \ (\text{mod } m) \equiv a_2\ (\text{mod } m) + b_2\ (\text{mod } m)\). Also, \(a_1b_1 = a_2b_2\ (\text{mod } m)=a_2\ (\text{mod } m) b_2\ (\text{mod } m)\)
        \item Let \(a \in \Z\). Then \(ab \equiv 1\ (\text{mod } m)\) for some \(b\equiv \Z \iff \gcd(a,m)=1\)
    \end{enumerate}}
\vspace*{-1.5em}

\wrpdef{Ring}{We write \(\Z/m\Z = \{0,1,2,\dots,m-1\}\) and call \(\Z / m\Z\) the \textit{ring of integers modulo} \(m\). We add and multiplying them as integers and then dividing the result by \(m\) and taking the remainder in order to obtain an element in \(\Z/m\Z\).}

Note that we will be finding the more traditional rings that are brought up in Algebra. Thus, for a ring to be a ring, it must have the following properties: \begin{enumerate}[label=\arabic*.]
    \item \textbf{Additive Closure:} For any \( a, b \in R \), the sum \( a + b \) is also in \( R \).
    \item \textbf{Associativity of Addition:} For any \( a, b, c \in R \), \( (a + b) + c = a + (b + c) \).
    \item \textbf{Commutativity of Addition:} For any \( a, b \in R \), \( a + b = b + a \).
    \item \textbf{Additive Identity:} There exists an element \( 0 \in R \) such that for any \( a \in R \), \( a + 0 = a \).
    \item \textbf{Additive Inverses:} For each \( a \in R \), there exists an element \( -a \in R \) such that \( a + (-a) = 0 \).
    \item \textbf{Multiplicative Closure:} For any \( a, b \in R \), the product \( a \cdot b \) is also in \( R \).
    \item \textbf{Associativity of Multiplication:} For any \( a, b, c \in R \), \( (a \cdot b) \cdot c = a \cdot (b \cdot c) \).
    \item \textbf{Distributive Property:} For any \( a, b, c \in R \), \( a \cdot (b + c) = a \cdot b + a \cdot c \) and \( (a + b) \cdot c = a \cdot c + b \cdot c \).
\end{enumerate}

\begin{example}
    {\((\Z_6, \cdot)\)}Find the ring of integers modulo 6 bound under multiplication.
\end{example}

\lesol{
    Note that from the following table, 6 only has 2 inverses, \(1\) and \(5\). This is because in their respective column, there is a 1 in each row.
    \begin{center}
        \begin{tabular}{|c|c|c|c|c|c|c|}
            \hline
            \(a\)         & 0 & 1 & 2 & 3 & 4 & 5 \\
            \hline
            \(a \cdot 0\) & 0 & 0 & 0 & 0 & 0 & 0 \\
            \hline
            \(a \cdot 1\) & 0 & 1 & 2 & 3 & 4 & 5 \\
            \hline
            \(a \cdot 2\) & 0 & 2 & 4 & 0 & 2 & 4 \\
            \hline
            \(a \cdot 3\) & 0 & 3 & 0 & 3 & 0 & 3 \\
            \hline
            \(a \cdot 4\) & 0 & 4 & 2 & 0 & 4 & 2 \\
            \hline
            \(a \cdot 5\) & 0 & 5 & 4 & 3 & 2 & 1 \\
            \hline
        \end{tabular}
    \end{center}

}

\wrpdef{Unit}{Recall from \refprop{1.13} that \(a\) has an inverse modulo \(m\) if and only if \(\gcd(a, m) = 1\). Numbers that have inverses are called \textit{units}. We denote the set of all units by
    \begin{align*}
        {(\Z/m\Z)}^* & = \{a \in \Z/m\Z \mid \gcd(a,m) = 1\}                      \\
                     & = \{a \in \Z/m\Z \mid \text{a has an inverse modulo } m.\}
    \end{align*}}
\begin{center}
    \textbf{Click \hyperref[sec:Theory groups]{this link} to be teleported to section 2.5 where we discuss Groups. We use groups throughout the remainder of Chapter 1.} \\
\end{center}


\wrpdef{Euler's Phi Function}{The function \(\varphi(m)\) defined by the rule \[\varphi(m) = |\{0 \leq a < m \mid \gcd(a,m) = 1\}| \]}
\vspace*{-1em}

\subsection{Modular Arithmetic and Shift Ciphers}

\begin{example}
    {Shift Cipher} Let's say we have a shift cipher with a key of 3. We want to encrypt the message ``HELLO''. What is the encrypted message?
\end{example}

\lesol{
    By shifting the letters by 3, we get ``KHOOR''. For the decryption, we would shift the letters by -3 to get the original message.
}


\subsection{Fast Powering Algorithm}
\label{fast powering algorithm}

We can write the algorithm as follows: \begin{enumerate}[label=\arabic*.]
    \item Write the exponent in binary.
    \item Compute the powers of the base in binary. For example,
          \begin{align*}
              k_0 & = a \ (\text{mod } m)                                              \\
              k_1 & = k_0^2 \ (\text{mod } m) = a^2 \ (\text{mod } m)                  \\
              k_2 & = k_1^2 \ (\text{mod } m) = (a^2)^{2} \ (\text{mod } m)            \\
                  & \vdots                                                             \\
              k_r & = k_{r-1}^2 \ (\text{mod } m) = (a^{2^{n-1}})^2 \ (\text{mod } m).
          \end{align*}
    \item Multiply the powers of the base that correspond to the 1s in the binary representation of the exponent.
          Compute \(a_b \ (\text{mod } m)\) by using \[a^b = a^{b_0 \cdot b_{12} + \cdots + b_r2^r}\]
\end{enumerate}

\begin{example}
    {Fast Powering Algorithm} Compute \(3^{218} \ (\text{mod } 1000)\).
\end{example}


\lesol{
    The first step is to write 218 in binary: \(218 = 11011010\). Then, we can write the powers of 3 in binary: \begin{align*}
        3^1     & = 3 \ (\text{mod } 1000) = 3       \\
        3^2     & = 3^2 \ (\text{mod } 1000) = 9     \\
        3^4     & = 9^2 \ (\text{mod } 1000) = 81    \\
        3^8     & = 81^2 \ (\text{mod } 1000) = 561  \\
        3^{16}  & = 561^2 \ (\text{mod } 1000) = 721 \\
        3^{32}  & = 721^2 \ (\text{mod } 1000) = 841 \\
        3^{64}  & = 841^2 \ (\text{mod } 1000) = 281 \\
        3^{128} & = 281^2 \ (\text{mod } 1000) = 961
    \end{align*} Now, we can calculate the value of \(3^{218}\) by multiplying the values of \(3^{128}\), \(3^{64}\), \(3^{16}\), \(3^{8}\), and \(3^{2}\) together: \begin{align*}
        3^{218} & = 3^{128} \times 3^{64} \times 3^{16} \times 3^{8} \times 3^{2} \\
                & = 961 \times 281 \times 721 \times 561 \times 9                 \\
                & = 489 \ (\text{mod } 1000)
    \end{align*}
}

\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand{\labelenumi}{(\theenumi)}
\subsection{Exercises}

\begin{exercise}
    {1.17}Find all values of \(x\) between \(0\) and \(m - 1\) that are solutions of the following congruences.\ (\textit{Hint:} If you can't figure out a clever way to find the solution(s), you can just substitute each value \(x = 1\).\ \(x = 2,\dots\).\ \(x = m - 1\) and see which ones work.)
    \begin{enumerate}
        \item \(x + 17 \equiv 23 \ (\text{mod } 37)\).
              \setcounter{enumi}{2}
        \item \(x^2 \equiv 3 \ (\text{mod } 11)\)
              \setcounter{enumi}{6}
        \item \(x \equiv 1 \ (\text{mod } 5)\) and also, \(x \equiv 2 \ (\text{mod } 7)\).\ (Find all solutions modulo 35, that is, find the solutions satisfying \(0 \leq x \leq 34\).)
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item \(x = 6\)
              \setcounter{enumi}{2}
        \item We know that \(x\) cannot be any number who's square does not exceed 11 because we cannot square a number to get \(3\) (other than \(\sqrt{3}\). But these are only the integers, so we cannot use that). Hence, \(x \ne 1,2,3\) because we know that the results of these, \(1^2 = 1\).\ \(2^2 = 4\).\ \(3^2 = 9\) are not equivalent to 3. Let's try some more values: \(x = 4\): \(4^2 = 16 \ (\text{mod } 11) = 5 \ \slashed{\equiv} \ 3\); \(x = 5\): \(5^2 = 25 \ (\text{mod } 11) = 3 \equiv 3\); \(x = 6\): \(6^2 = 36 \ (\text{mod } 11) = 3 \equiv 3\); \(x = 7\): \(7^2 = 49 \ (\text{mod } 11) = 5 \ \slashed{\equiv} \ 3\); \(x = 8\): \(8^2 = 64 \ (\text{mod } 11) = 9 \ \slashed{\equiv} \ 3\); \(x = 9\): \(9^2 = 81 \ (\text{mod } 11) = 4 \ \slashed{\equiv} \ 3\); \(x = 10\): \(10^2 = 100 \ (\text{mod } 11) = 1 \ \slashed{\equiv} \ 3\).

              Thus, we have it that \(x = 5,6\).
              \setcounter{enumi}{6}
        \item Because we have \(x \equiv 1 \ (\text{mod } 5)\). Verifying correct \(x\)'s are straightforward. All we need to check for is if a multiple of \(5 + 1\) satisfies \(x \equiv 2 \ (\text{mod } 7)\). Thus, the only solution is \(x = 16\)
    \end{enumerate}
}

\begin{exercise}
    {1.19}Prove that if \(a_1\) and \(a_2\) are units modulo \(m\). Then \(a_1a_2\) is a unit modulo \(m\).
\end{exercise}

\expf{
    Suppose \(a_1\) and \(a_2\) are units modulo \(m\). This means \(a \in \Z/m\Z \colon gcd(a,m) = 1\). In other words, \(a_1b_1 \equiv 1 \ (\text{mod } m)\) and \(a_2b_2 \equiv 1 \ (\text{mod } m)\) for some \(b_1, b_2 \in \Z\). When we multiply the equations together, we get \((a_1b_1)(a_2b_2) \equiv 1 \ (\text{mod } m)\) which can be rewritten as \((a_1a_2)(b_1b_2) \equiv 1 \ (\text{mod } m)\). We can multiply \(b_1\) and \(b_2\) to get an integer \(b_3\). Thus, when we multiply \(a_1a_2\) by \(b_3\) and get \(1\). We have shown that \(b_3\) is a multiplicative inverse, and \(a_1a_2\) is a unit modulo \(m\).
}

\begin{exercise}
    {1.26}Use the square-and-multiply algorithm described in \hyperref[fast powering algorithm]{Section 1.3.2}, or the more efficient version in Exercise 1.25, to compute the following powers.
    \begin{enumerate}
        \item \(17^{183} \ (\text{mod } 256)\)
        \item \(2^{477} \ (\text{mod } 1000)\)
    \end{enumerate}
\end{exercise}




\sol{ \hfill
    \begin{enumerate}
        \item \(a = 17\), \(b = 1\), \(A = 183\), and \(N = 256\). We will now begin the loop because \(A > 0\)
              \begin{itemize}
                  \item \(A = 183\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 256) = 1 \cdot 17 \ (\text{mod } 256) = 17\); and \(a = a^2 \ (\text{mod } 256) = 17^2 \ (\text{mod 256}) = 33\). \(A = \lfloor 182 / 2 \rfloor = 91\).
                  \item \(A = 91\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 256) = 17 \cdot 33 \ (\text{mod } 256) = 49\); and \(a = a^2 \ (\text{mod } 256) = 33^2 \ (\text{mod 256}) = 65\). \(A = \lfloor 91 / 2 \rfloor = 45\).
                  \item \(A = 45\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 256) = 49 \cdot 65 \ (\text{mod } 256) = 113\); and \(a = a^2 \ (\text{mod } 256) = 65^2 \ (\text{mod 256}) = 129\). \(A = \lfloor 45 / 2 \rfloor = 22\).
                  \item \(A = 22\) is even. Therefore, \(a = a^2 \ (\text{mod } 256) = 129^2 \ (\text{mod 256}) = 1\). \(A = \lfloor 22 / 2 \rfloor = 11\).
                  \item \(A = 11\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 256) = 113 \cdot 1 \ (\text{mod } 256) = 113\); and \(a = a^2 \ (\text{mod } 256) = 1^2 \ (\text{mod 256}) = 1\). \(A = \lfloor 11 / 2 \rfloor = 5\).
                  \item \(A = 5\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 256) = 113 \cdot 1 \ (\text{mod } 256) = 113\); and \(a = a^2 \ (\text{mod } 256) = 1^2 \ (\text{mod 256}) = 1\). \(A = \lfloor 5 / 2 \rfloor = 2\).
                  \item \(A = 2\) is even. Therefore, \(a = a^2 \ (\text{mod } 256) = 1^2 \ (\text{mod 256}) = 1\). \(A = \lfloor 2 / 2 \rfloor = 1\).
                  \item \(A = 1\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 256) = 113 \cdot 1 \ (\text{mod } 256) = 113\); and \(a = a^2 \ (\text{mod } 256) = 1^2 \ (\text{mod 256}) = 1\). \(A = \lfloor 1 / 2 \rfloor = 0\).
              \end{itemize}
              Since \(A = 0\), we can report the value of \(b\), which is \(113\). Hence, \(17^183 \ (\text{mod }256) = 113\).
        \item \(a = 2\), \(b = 1\), \(A = 477\), \(N = 1000\). We will now begin the loop because \(A > 0\)
              \begin{itemize}
                  \item \(A = 477\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 1000) = 1 \cdot 2 \ (\text{mod } 1000) = 2\); and \(a = a^2 \ (\text{mod } 1000) = 2^2 \ (\text{mod } 1000) = 4\). \(A = \lfloor 477 / 2 \rfloor = 238\).
                  \item \(A = 238\) is even. Therefore, \(a = a^2 \ (\text{mod } 1000) = 4^2 \ (\text{mod } 1000) = 16\). \(A = \lfloor 238 / 2 \rfloor = 119\).
                  \item \(A = 119\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 1000) = 2 \cdot 16 \ (\text{mod } 1000) = 32\); and \(a = a^2 \ (\text{mod } 1000) = 16^2 \ (\text{mod } 1000) = 256\). \(A = \lfloor 119 / 2 \rfloor = 59\).
                  \item \(A = 59\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 1000) = 32 \cdot 256 \ (\text{mod } 1000) = 192\); and \(a = a^2 \ (\text{mod } 1000) = 256^2 \ (\text{mod } 1000) = 536\). \(A = \lfloor 59 / 2 \rfloor = 29\).
                  \item \(A = 29\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 1000) = 192 \cdot 536 \ (\text{mod } 1000) = 912\); and \(a = a^2 \ (\text{mod } 1000) = 536^2 \ (\text{mod } 1000) = 296\). \(A = \lfloor 29 / 2 \rfloor = 14\).
                  \item \(A = 14\) is even. Therefore, \(a = a^2 \ (\text{mod } 1000) = 296^2 \ (\text{mod } 1000) = 616\). \(A = \lfloor 14 / 2 \rfloor = 7\).
                  \item \(A = 7\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 1000) = 912 \cdot 616 \ (\text{mod } 1000) = 792\); and \(a = a^2 \ (\text{mod } 1000) = 616^2 \ (\text{mod } 1000) = 456\). \(A = \lfloor 7 / 2 \rfloor = 3\).
                  \item \(A = 3\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 1000) = 792 \cdot 456 \ (\text{mod } 1000) = 152\); and \(a = a^2 \ (\text{mod } 1000) = 456^2 \ (\text{mod } 1000) = 936\). \(A = \lfloor 3 / 2 \rfloor = 1\).
                  \item \(A = 1\) is odd. Therefore, \(b = b \cdot a \ (\text{mod } 1000) = 152 \cdot 936 \ (\text{mod } 1000) = 272\); and \(a = a^2 \ (\text{mod } 1000) = 936^2 \ (\text{mod } 1000) = 96\). \(A = \lfloor 1 / 2 \rfloor = 0\).
              \end{itemize}
              Since \(A = 0\), we can report the value of \(b\), which is \(272\). Hence, \(2^477 \ (\text{mod }1000) = 272\).
    \end{enumerate}
}

\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumi}{\theenumi.}
\section{Prime Numbers, Unique Factorization, and Finite Fields}

\wrpdef{Prime Number}{A prime number is a positive integer greater than 1 whose only divisors are 1 and itself.}

\wrpprop{1.19}{Let \(p\) be a prime number with \(a,b \in \Z\) such that \(p \mid ab\). Then \(p \mid a\) or \(p \mid b\).}

\begin{theorem}
    {Fundamental Theorem of Arithmetic}Let \(a \geq 2\) be an integer. Then \(a\) can be factored as a product of prime numbers \[a = p_1^{e_1} \cdot p_2^{e_2} \cdots p_r^{e_r}.\] Further, other than rearranging the order of the factors, this factorization is unique.
\end{theorem}

\wrpprop{1.21}{Let \(p\) be prime. Then every non-zero element of \(\Z/p\Z\) has a multiplicative inverse. Put another way, \(x \in \Z_p\) has a multiplicative inverse if and only if \(\gcd(x,p) = 1\) because of \refprop{1.13}.}

\newpage

\wrpdef{Field}{If \(p\) is prime, then \(\Z/p\Z\) of integers modulo \(p\) with its addition, subtraction, multiplication, and division rules is a \textit{field}. See the definition of \hyperref[Ring]{Ring} for more information on the properties of a field. (Note that a field is a type of ring, called a communicative ring.) We often notate fields as \(\F_p\) and \(\F_p^*\) as the group of units.}

\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumi}{\theenumi.}
\section{Powers and Primitive Roots in Finite Fields}
\label{thm:Fermat's Little Theorem}

\begin{theorem}
    {Fermat's Little Theorem} Let \(p\) be a prime number and \(a\) be an integer. Then, \[a^{p - 1} \equiv \begin{cases}
            1 \ (\text{mod } p) & \text{if } p \nmid a \\
            0 \ (\text{mod } p) & \text{if } p \mid a
        \end{cases}\]
\end{theorem}

\begin{example}
    {Order 1}Find the order of 2 modulo 7.
\end{example}

\lesol{\(2^3 = 8 \ (\text{mod } 7) = 1\). Thus, the order of 2 modulo 7 is 3.}

\begin{example}
    {Order 2}Find the order of 5 modulo 7.
\end{example}

\lesol{\(5^6 = 15625 \ (\text{mod } 7) = 1\). Thus, the order of 5 modulo 7 is 6.}

\begin{theorem}
    {Primitive Root Theorem}Let \(p\) be a prime number. Then there exists an integer \(g\) such that there exists an \(x \in \F_p^*\) whose powers give every element of \(\F_p^*\), i.e., \[\F_p^* = \{1,g,g^2,g^3.\dots,g^{p - 2}\}.\] Elements with this property are called the \textit{primitive roots of} \(\F_p\) or \textit{generators of} \(\F_p^*\). They are elements of order \(p - 1\).
\end{theorem}

\newpage

\begin{example}
    {Primitive Root}Find a primitive root modulo 7.
\end{example}

\lesol{We can look to the \hyperref[thm:Primitive Root Theorem]{Primitive Root Theorem} to see how many primitive roots are \(7\) has. Because 7 is prime, we know that \(\varphi = 6\). Thus, we know that 7 will have 6 primitive roots. Because there are 6 primitive roots in total, and \(\F_7^*\) has 7 elements (including 0), we know that 1-6 will be the primitive roots.}

\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand{\labelenumi}{(\theenumi)}
\subsection{Exercises}

\begin{exercise}
    {1.32}For each of the following primes \( p \) and numbers \( a \), compute \( a^{-1} \bmod p \) in two ways: (i) the extended Euclidean algorithm. (ii) Use the fast power algorithm and Fermat's little theorem. (See Example 1.27.)
    \begin{enumerate}
        \item \( p = 47 \) and \( a = 11 \).
        \item \( p = 587 \) and \( a = 345 \).
    \end{enumerate}
\end{exercise}

\sol{ \hfill
    \begin{enumerate}
        \item \begin{enumerate}[label=(\roman*)]
                  \item For the extended Euclidean algorithm, we can start by filling out this table:
                        \begin{center}
                            \begin{tabular}{c|c|c|c|c|c}
                                \textit{i} & \textit{\(r_i\)} & \textit{\(q_i\)} & \(r_{i + 1}\) & \textit{\(u_i\)}        & \textit{\(v_i\)}          \\ \hline
                                \textit{0} & \(47\)           & \(-\)            & \(-\)         & \(1\)                   & \(0\)                     \\ \hline
                                \textit{1} & \(11\)           & \(4\)            & \(3\)         & \(0\)                   & \(1\)                     \\ \hline
                                \textit{2} & \(3\)            & \(3\)            & \(2\)         & \(1\)                   & \(0 - 4 \cdot 1 = -4\)    \\ \hline
                                \textit{3} & \(2\)            & \(1\)            & \(1\)         & \(0 - 3 \cdot 1 = -4\)  & \(1 - 3 \cdot -4 = 13\)   \\ \hline
                                \textit{4} & \(1\)            & \(2\)            & \(0\)         & \(1 - 1 \times -4 = 4\) & \(-4 - 1 \cdot 13 = -17\)
                            \end{tabular} \\
                        \end{center}
                        Thus, to find  \(a^{-1} \ (\text{mod } p)\), we need an \(x\) such that \(11x \equiv 1 \ (\text{mod } 47)\). From our table, we know that number to be \(-17\) because \(1 = 4 \times 47 - 17 \times 11\). Then, as a positive number \(\text{mod } 47\), we get \(x \equiv -17 \equiv 30 \ (\text{mod } 47)\).
                  \item For Fermat's Little Theorem:
                        \begin{align*}
                            a^{p - 1} & \equiv 1 \ (\text{mod } p)      \\
                            a^{p - 2} & \equiv a^{-1} \ (\text{mod } p) \\
                            11^{45}   & \ (\text{mod } 47)
                        \end{align*}
                        By the fast power algorithm, we need to find the binary representation of 45. Thus, \(45 \ (\text{mod } 2) = 1\), \(22 \ (\text{mod } 2) = 0\), \(11 \ (\text{mod } 2) = 1\), \(5 \ (\text{mod } 2) = 1\), \(2 \ (\text{mod } 2) = 0\), \(1 \ (\text{mod } 2) = 1\). From this, we have the binary representation of \(45_{10}\) as \(101101_2\). Hence, we will need to calculate \(2^5 \cdot 2^3 \cdot 2^2 \cdot 2^1 \cdot 2^0 \Rightarrow 11^{2^5} \cdot 11^{2^3} \cdot 11^{2^0} \Rightarrow 11^{32} \cdot 11^8 \cdot 11^4 \cdot 11 \equiv 17 \cdot 14 \cdot 25 \cdot 11\). Now, these are:
                        \begin{align*}
                            11^1    & \equiv 11 \ (\text{mod } 47) \\
                            11^2    & \equiv 27 \ (\text{mod } 47) \\
                            11^4    & \equiv 25 \ (\text{mod } 47) \\
                            11^8    & \equiv 14 \ (\text{mod } 47) \\
                            11^{16} & \equiv 8 \ (\text{mod } 47)  \\
                            11^{32} & \equiv 17 \ (\text{mod } 47)
                        \end{align*}
                        Now, we can calculate \(11^{45} = 11^{32} \cdot 11^8 \cdot 11^4 \cdot 11 \equiv 17 \cdot 14 \cdot 25 \cdot 11 \ (\text{mod } 47)\). Further, multiplying we get \(17 \cdot 14 \ (\text{mod } 47) \equiv 3\). Then, \(3 \cdot 25 \ (\text{mod } 47) \equiv 28\). Finally, \(28 \cdot 11 \ (\text{mod } 47) \equiv 30\). Thus confirming our previous answer in (i).
              \end{enumerate}
              %
              %
              %
              %
              %   
        \item \begin{enumerate}[label=(\roman*)]
                  \item For the extended Euclidean algorithm:
                        \begin{center}
                            \begin{tabular}{c|c|c|c|c|c}
                                \textit{i} & \textit{\(r_i\)} & \textit{\(q_i\)} & \(r_{i + 1}\) & \textit{\(u_i\)}          & \textit{\(v_i\)}           \\ \hline
                                \textit{0} & \(587\)          & \(-\)            & \(-\)         & \(1\)                     & \(0\)                      \\ \hline
                                \textit{1} & \(345\)          & \(1\)            & \(242\)       & \(0\)                     & \(1\)                      \\ \hline
                                \textit{2} & \(242\)          & \(1\)            & \(103\)       & \(1\)                     & \(0 - 1 \cdot 1 = -1\)     \\ \hline
                                \textit{3} & \(103\)          & \(2\)            & \(36\)        & \(0 - 1 \cdot 1 = -1\)    & \(1 - 1 \cdot -1 = 2\)     \\ \hline
                                \textit{4} & \(36\)           & \(2\)            & \(31\)        & \(1 - 2 \cdot -1 = 3\)    & \(-1 - 2 \cdot 2 = -5\)    \\ \hline
                                \textit{5} & \(31\)           & \(1\)            & \(5\)         & \(-1 - 2 \cdot 3 = -7\)   & \(2 - 2 \cdot -5 = 12\)    \\ \hline
                                \textit{6} & \(5\)            & \(6\)            & \(1\)         & \(3 - 1 \cdot -7 = 10\)   & \(-5 - 1 \cdot 12 = -17\)  \\ \hline
                                \textit{7} & \(1\)            & \(5\)            & \(0\)         & \(10 - 6 \cdot 10 = -67\) & \(12 - 6 \cdot -17 = 114\)
                            \end{tabular}
                        \end{center}
                        Thus, the inverse of \(345 \ (\text{mod } 587)\) is 114.

                  \item The binary expression for \(585_{10}\) is \(1001001001_2\) (I just used my calculator this time and kept dividing ans by 2 while keeping track of the odd vs even quotients). This leaves us with \(345^{2^9} \cdot 345^{2^6} \cdot 345^{2^3} \cdot 345^{2^0}\).
                        \begin{align*}
                            345^1     & \equiv 345 \ (\text{mod } 587) \\
                            345^2     & \equiv 451 \ (\text{mod } 587) \\
                            345^4     & \equiv 299 \ (\text{mod } 587) \\
                            345^8     & \equiv 177 \ (\text{mod } 587) \\
                            345^{16}  & \equiv 218 \ (\text{mod } 587) \\
                            345^{64}  & \equiv 529 \ (\text{mod } 587) \\
                            345^{128} & \equiv 429 \ (\text{mod } 587) \\
                            345^{256} & \equiv 310 \ (\text{mod } 587) \\
                            345^{512} & \equiv 419 \ (\text{mod } 587)
                        \end{align*}
                        Now we can multiply and solve: \(345^{2^9} \cdot 345^{2^6} \cdot 345^{2^3} \cdot 345^{2^0} \Rightarrow 419 \cdot 529 \cdot 177 \cdot 345 \ (\text{mod } 587) = 114\). Therefore, the inverse of \(345 \ (\text{mod } 587)\) is \(114\).
              \end{enumerate}
    \end{enumerate}
}

\begin{exercise}
    {1.34}Recall that \( g \) is called a primitive root modulo \( p \) if the powers of \( g \) give all nonzero elements of \( \mathbb{F}_p \).
    \begin{enumerate}[label=(\alph*)]
        \item For which of the following primes is 2 a primitive root modulo \( p \)?
              \[
                  \begin{array}{llllllll}
                      \text{(i)} & p = 7 & \text{(ii)} & p = 13 & \text{(iii)} & p = 19 & \text{(iv)} & p = 23
                  \end{array}
              \]
        \item For which of the following primes is 3 a primitive root modulo \( p \)?
              \[
                  \begin{array}{llllllll}
                      \text{(i)} & p = 5 & \text{(ii)} & p = 7 & \text{(iii)} & p = 11 & \text{(iv)} & p = 17
                  \end{array}
              \]
        \item Find a primitive root for each of the following primes.
              \[
                  \begin{array}{llllllll}
                      \text{(i)} & p = 23 & \text{(ii)} & p = 29 & \text{(iii)} & p = 41 & \text{(iv)} & p = 43
                  \end{array}
              \]
        \item Find all primitive roots modulo 11. Verify that there are exactly \(\phi(10)\) of them, as asserted in Remark 1.32.
    \end{enumerate}
\end{exercise}

\sol{ \hfill
    \begin{enumerate}
        \item \begin{enumerate}[label=(\roman*)]
                  \item \(p = 7\): \(2^1 \equiv 2\), \(2^2 \equiv 4\), \(2^3 \equiv 1 \ (\text{mod } 7)\). Because \(2\) does not cover every nonzero elements of \( \mathbb{F}_p \), \(2\) is not a primitive root.
                  \item \(p = 13\): \(2^1 \equiv 2\), \(2^2 \equiv 4\), \(2^3 \equiv 8\), \(2^4 \equiv 3\), \(2^5 \equiv 6\), \(2^6 \equiv 12\), \(2^7 \equiv 11\), \(2^8 \equiv 9\), \(2^9 \equiv 5\), \(2^{10} \equiv 10\), \(2^{11} \equiv 7\), \(2^{12} \equiv 1\), \(2\) is a primitive root.
                  \item \(p = 19\): \(2^1 \equiv 2\), \(2^2 \equiv 4\), \(2^3 \equiv 8\), \(2^{4} \equiv 16\), \(2^{5} \equiv 13\), \(2^{6} \equiv 7\), \(2^{7} \equiv 14\), \(2^{8} \equiv 9\), \(2^{9} \equiv 18\), \(2^{10} \equiv 17\), \(2^{11} \equiv 15\), \(2^{12} \equiv 11\), \(2^{13} \equiv 3\), \(2^{14} \equiv 6\), \(2^{15} \equiv 12\), \(2^{16} \equiv 5\), \(2^{17} \equiv 10\), \(2^{18} \equiv 1\), 2 is a primitive root.
                  \item \(p = 23\): \(2^1 \equiv 2\), \(2^2 \equiv 4\), \(2^3 \equiv 8\), \(2^{4} \equiv 16\), \(2^{5} \equiv 9\), \(2^{6} \equiv 18\), \(2^{7} \equiv 13\), \(2^{8} \equiv 3\), \(2^{9} \equiv 6\), \(2^{10} \equiv 12\), \(2^{11} \equiv 1\), \(2\) is not a primitive root.
              \end{enumerate}
        \item \begin{enumerate}[label=(\roman*)]
                  \item \( p = 5 \): \( 3^1 \equiv 3, 3^2 \equiv 4, 3^3 \equiv 2, 3^4 \equiv 1 \), 3 is a primitive root.
                  \item \( p = 7 \): \( 3^1 \equiv 3, 3^2 \equiv 2, \ldots, 3^6 \equiv 1 \), 3 is a primitive root.
                  \item \( p = 11 \): \( 3^1 \equiv 3, 3^2 \equiv 9, 3^3 \equiv 5, \ldots, 3^5 \equiv 1 \), 3 is not a primitive root.
                  \item \( p = 17 \): \( 3^1 \equiv 3, 3^2 \equiv 9, \ldots, 3^{16} \equiv 1 \), 3 is a primitive root.
              \end{enumerate}
        \item \begin{enumerate}[label=(\roman*)]
                  \item \(p = 23\): \(5^1 \equiv 5\), \(5^{2} \equiv 2\), \(5^{3} \equiv 10\), \(5^{4} \equiv 4\), \(5^{5} \equiv 20\), \(5^{6} \equiv 8\), \(5^{7} \equiv 17\), \(5^{8} \equiv 16\), \(5^{9} \equiv 11\), \(5^{10} \equiv 9\), \(5^{11} \equiv 22\), \(5^{12} \equiv 18\), \(5^{13} \equiv 21\), \(5^{14} \equiv 13\), \(5^{15} \equiv 19\), \(5^{16} \equiv 3\), \(5^{17} \equiv 15\), \(5^{18} \equiv 6\), \(5^{19} \equiv 7\), \(5^{20} \equiv 12\), \(5^{21} \equiv 14\), \(5^{22} \equiv 1\).\\

                        \(5\) is a primitive root.
                  \item \(2^1 \equiv 2\), \(2^{2} \equiv 4\), \(2^{3} \equiv 8\), \(2^{4} \equiv 16\), \(2^{5} \equiv 3\), \(2^{6} \equiv 6\), \(2^{7} \equiv 12\), \(2^{8} \equiv 24\), \(2^{9} \equiv 19\), \(2^{10} \equiv 9\), \(2^{11} \equiv 18\), \(2^{12} \equiv 7\), \(2^{13} \equiv 14\), \(2^{14} \equiv 28\), \(2^{15} \equiv 27\), \(2^{16} \equiv 25\), \(2^{17} \equiv 21\), \(2^{18} \equiv 13\), \(2^{19} \equiv 26\), \(2^{20} \equiv 23\), \(2^{21} \equiv 17\), \(2^{22} \equiv 5\), \(2^{23} \equiv 10\), \(2^{24} \equiv 20\), \(2^{25} \equiv 11\), \(2^{26} \equiv 22\), \(2^{27} \equiv 15\),
                        \(2^{28} \equiv 1\). \\

                        \(2\) is a primitive root.
                  \item \(6^{1} \equiv 6\), \(6^{2} \equiv 36\), \(6^{3} \equiv 11\), \(6^{4} \equiv 25\), \(6^{5} \equiv 27\), \(6^{6} \equiv 39\), \(6^{7} \equiv 29\), \(6^{8} \equiv 10\), \(6^{9} \equiv 19\), \(6^{10} \equiv 32\), \(6^{11} \equiv 28\), \(6^{12} \equiv 4\), \(6^{13} \equiv 24\), \(6^{14} \equiv 21\), \(6^{15} \equiv 3\), \(6^{16} \equiv 18\), \(6^{17} \equiv 26\), \(6^{18} \equiv 33\), \(6^{19} \equiv 34\), \(6^{20} \equiv 40\), \(6^{21} \equiv 35\), \(6^{22} \equiv 5\), \(6^{23} \equiv 30\), \(6^{24} \equiv 16\), \(6^{25} \equiv 14\), \(6^{26} \equiv 2\), \(6^{27} \equiv 12\), \(6^{28} \equiv 31\), \(6^{29} \equiv 22\), \(6^{30} \equiv 9\), \(6^{31} \equiv 13\), \(6^{32} \equiv 37\), \(6^{33} \equiv 17\), \(6^{34} \equiv 20\), \(6^{35} \equiv 38\), \(6^{36} \equiv 23\), \(6^{37} \equiv 15\), \(6^{38} \equiv 8\), \(6^{39} \equiv 7\), \(6^{40} \equiv 1\).\\

                        \(6\) is a primitive root.
                  \item \(3^{1} \equiv 3\), \(3^{2} \equiv 9\), \(3^{3} \equiv 27\), \(3^{4} \equiv 38\), \(3^{5} \equiv 28\), \(3^{6} \equiv 41\), \(3^{7} \equiv 37\), \(3^{8} \equiv 25\), \(3^{9} \equiv 32\), \(3^{10} \equiv 10\), \(3^{11} \equiv 30\), \(3^{12} \equiv 4\), \(3^{13} \equiv 12\), \(3^{14} \equiv 36\), \(3^{15} \equiv 22\), \(3^{16} \equiv 23\), \(3^{17} \equiv 26\), \(3^{18} \equiv 35\), \(3^{19} \equiv 19\), \(3^{20} \equiv 14\), \(3^{21} \equiv 42\), \(3^{22} \equiv 40\), \(3^{23} \equiv 34\), \(3^{24} \equiv 16\), \(3^{25} \equiv 5\), \(3^{26} \equiv 15\), \(3^{27} \equiv 2\), \(3^{28} \equiv 6\), \(3^{29} \equiv 18\), \(3^{30} \equiv 11\), \(3^{31} \equiv 33\), \(3^{32} \equiv 13\), \(3^{33} \equiv 39\), \(3^{34} \equiv 31\), \(3^{35} \equiv 7\), \(3^{36} \equiv 21\), \(3^{37} \equiv 20\), \(3^{38} \equiv 17\), \(3^{39} \equiv 8\), \(3^{40} \equiv 24\), \(3^{41} \equiv 29\),
                        \(3^{42} \equiv 1\). \\

                        \(3\) is a primitive root.
              \end{enumerate}
        \item The primitive roots modulo 11 are 2, 6, 7, 8. To check: \\
              \(2^1 \equiv 11 = 2\), \(2^2 \equiv 11 = 4\), \(2^3 \equiv 11 = 8\), \(2^4 \equiv 11 = 5\), \(2^5 \equiv 11 = 10\), \(2^6 \equiv 11 = 9\), \(2^7 \equiv 11 = 7\), \(2^8 \equiv 11 = 3\), \(2^9 \equiv 11 = 6\), \(2^{10} \equiv 11 = 1\),

              2 is a primitive root. \\

              \(6^1 \equiv 11 = 6\), \(6^2 \equiv 11 = 3\), \(6^3 \equiv 11 = 7\), \(6^4 \equiv 11 = 9\), \(6^5 \equiv 11 = 10\), \(6^6 \equiv 11 = 5\), \(6^7 \equiv 11 = 8\), \(6^8 \equiv 11 = 4\), \(6^9 \equiv 11 = 2\), \(6^{10} \equiv 11 = 1\),

              6 is a primitive root. \\

              \(7^1 \equiv 11 = 7\), \(7^2 \equiv 11 = 5\), \(7^3 \equiv 11 = 2\), \(7^4 \equiv 11 = 3\), \(7^5 \equiv 11 = 10\), \(7^6 \equiv 11 = 4\), \(7^7 \equiv 11 = 6\), \(7^8 \equiv 11 = 9\), \(7^9 \equiv 11 = 8\), \(7^{10} \equiv 11 = 1\),

              7 is a primitive root. \\

              \(8^1 \equiv 11 = 8\), \(8^2 \equiv 11 = 9\), \(8^3 \equiv 11 = 6\), \(8^4 \equiv 11 = 4\), \(8^5 \equiv 11 = 10\), \(8^6 \equiv 11 = 3\), \(8^7 \equiv 11 = 2\), \(8^8 \equiv 11 = 5\), \(8^9 \equiv 11 = 7\), \(8^{10} \equiv 11 = 1\), 8 is a primitive root.
    \end{enumerate}
}
\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumi}{\theenumi.}
\section{Cryptography By Hand}

\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand{\labelenumi}{(\theenumi)}
\subsection{Exercises}

\begin{exercise}
    {1.41}A \textit{transposition cipher} is a cipher in which the letters of the plaintext remain the same, but their order is rearranged. Here is a simple example in which the message is encrypted in blocks of 25 letters at a time. Take the given 25 letters and arrange them in a 5-by-5 block by writing the message horizontally on the lines. For example, the first 25 letters of the message
    \[\texttt{Now is the time for all good men to come to the aid...} \]
    is written as
    \begin{center}
        \vspace*{-1cm}
        \[
            \begin{array}{ccccc}
                \texttt{N} & \texttt{0} & \texttt{W} & \texttt{I} & \texttt{S} \\
                \texttt{T} & \texttt{H} & \texttt{E} & \texttt{T} & \texttt{I} \\
                \texttt{M} & \texttt{E} & \texttt{F} & \texttt{O} & \texttt{R} \\
                \texttt{A} & \texttt{L} & \texttt{L} & \texttt{G} & \texttt{O} \\
                \texttt{O} & \texttt{D} & \texttt{M} & \texttt{E} & \texttt{N} \\
            \end{array}
        \]
    \end{center}
    Now the ciphertext is formed by reading the letters down the columns, which gives the ciphertext
    \[\texttt{NTMAO OHELD WEFLM ITOGE SIRON.}\]
    \begin{enumerate}
        \item Use this transposition cipher to encrypt the first 25 letters of the message
              \[\texttt{Four score and seven years ago our fathers...}\]
        \item The following message was encrypted using this transposition cipher. Decrypt it.
              \[\texttt{WNOOA HTUFN EHRHE NESUV ICEME.}\]
        \item There are many variations on this type of cipher. We can form the letters into a rectangle instead of a square, and we can use various patterns to place the letters into the rectangle and to read them back out. Try to decrypt the following  ciphertext, in which the letters were placed horizontally into a rectangle of some size and then read off vertically by columns.
              \[\texttt{WHNCE STRHT TEOOH ALBAT DETET SADHE}\]
              \vspace*{-1cm}
              \[\texttt{LEELL QSFMU EEEAT VNLRI ATUDR HTEEA}\]
              (For convenience, we’ve written the ciphertext in 5 letter blocks, but that doesn’t necessarily mean that the rectangle has a side of length 5.)
    \end{enumerate}
\end{exercise}

\sol{ \hfill
    \begin{enumerate}
        \item The first 25 letters of the sentence given is, ``Four score and seven year ago''. Written in block form:
              \begin{center}
                  \vspace*{-1cm}
                  \[
                      \begin{array}{ccccc}
                          \texttt{F} & \texttt{O} & \texttt{U} & \texttt{R} & \texttt{S} \\
                          \texttt{C} & \texttt{O} & \texttt{R} & \texttt{E} & \texttt{A} \\
                          \texttt{N} & \texttt{D} & \texttt{S} & \texttt{E} & \texttt{V} \\
                          \texttt{E} & \texttt{N} & \texttt{Y} & \texttt{E} & \texttt{A} \\
                          \texttt{R} & \texttt{S} & \texttt{A} & \texttt{G} & \texttt{O} \\
                      \end{array}
                  \]
              \end{center}
              Now the ciphertext is formed by reading the letters down the columns, which gives the ciphertext
              \[\texttt{FCNER OODNS URSYA REEEG SAVAO}\]
        \item To create a transposition cipher, we can read the sentence from the starting letter of each word from the sentence, and move inward. For example,
              \begin{enumerate}[label=(\arabic*)]
                  \item \boxed{W}NOOA \boxed{H}TUFN \boxed{E}HRHE \boxed{N}ESUV \boxed{I}CEME \(\Rightarrow\) ``When I...''
                  \item W\boxed{N}OOA H\boxed{T}UFN E\boxed{H}RHE N\boxed{E}SUV I\boxed{C}EME \(\Rightarrow\) ``...N The C...''
                  \item WN\boxed{O}OA HT\boxed{U}FN EH\boxed{R}HE NE\boxed{S}UV IC\boxed{E}ME \(\Rightarrow\) ``...ourse...''
                  \item WNO\boxed{O}A HTU\boxed{F}N EHR\boxed{H}E NES\boxed{U}V ICE\boxed{M}E \(\Rightarrow\) ``...Of Hum...''
                  \item WNOO\boxed{A} HTUF\boxed{N} EHRH\boxed{E} NESU\boxed{V} ICEM\boxed{E} \(\Rightarrow\) ``...an Eve.''
              \end{enumerate}
              Putting it all together, we get, ``\href{https://www.archives.gov/founding-docs/declaration-transcript}{When in the course of human eve...}'' (Declaration of Independence)
        \item This cipher is going to be a little difficult as we have to go through a couple of cases to see which pattern makes the most sense. If we consider the number of letters, 60, we can start at the lowest divisor, 2, and work our way up through the other divisors (this way, we won't start with extremely long ciphers that will each take up a whole page on their lonesome). Thus,
              \begin{itemize}
                  \item Reading by 2s (to get a \(2\times 30\) matrix)
                        \begin{center}
                            \vspace*{-1cm}
                            \[
                                \begin{array}{cccccccccccccccc}
                                    \texttt{W} & \texttt{N} & \texttt{E} & \texttt{T} & \texttt{H} & \texttt{T} & \texttt{O} & \texttt{H} & \texttt{L} & \texttt{A} & \texttt{D} & \texttt{T} & \texttt{A} & \texttt{H} & \texttt{L} & \texttt{E} \\
                                    \texttt{H} & \texttt{C} & \texttt{S} & \texttt{R} & \texttt{T} & \texttt{E} & \texttt{O} & \texttt{A} & \texttt{B} & \texttt{T} & \texttt{E} & \texttt{S} & \texttt{D} & \texttt{E} & \texttt{E} & \texttt{L}
                                \end{array}
                            \]
                            \vspace*{-1cm}
                        \end{center}
                        Clearly, even though we do not have all the letters, there are no words being formed. Let's move on.
                  \item Reading by 3s (to get a \(3\times 20\) matrix)
                        \begin{center}
                            \vspace*{-1cm}
                            \[
                                \begin{array}{cccccccccccccccccccc}
                                    \texttt{W} & \texttt{C} & \texttt{T} & \texttt{T} & \texttt{O} & \texttt{A} & \texttt{A} & \texttt{E} & \texttt{T} & \texttt{D} & \texttt{L} & \texttt{L} & \texttt{S} & \texttt{U} & \texttt{E} & \texttt{V} & \texttt{R} & \texttt{T} & \texttt{R} & \texttt{E} \\

                                    \texttt{H} & \texttt{E} & \texttt{R} & \texttt{T} & \texttt{O} & \texttt{L} & \texttt{T} & \texttt{T} & \texttt{S} & \texttt{H} & \texttt{E} & \texttt{L} & \texttt{F} & \texttt{E} & \texttt{A} & \texttt{N} & \texttt{I} & \texttt{U} & \texttt{H} & \texttt{E} \\

                                    \texttt{N} & \texttt{S} & \texttt{H} & \texttt{E} & \texttt{H} & \texttt{B} & \texttt{D} & \texttt{E} & \texttt{A} & \texttt{E} & \texttt{E} & \texttt{Q} & \texttt{M} & \texttt{E} & \texttt{T} & \texttt{L} & \texttt{A} & \texttt{D} & \texttt{T} & \texttt{A}
                                \end{array}
                            \]
                            \vspace*{-1cm}
                        \end{center}
                        There are no words here.
                  \item \(4 \times 15\) matrix
              \end{itemize}
              \begin{center}
                  \vspace*{-1cm}
                  \[
                      \begin{array}{ccccccccccccccc}
                          \texttt{W} & \texttt{E} & \texttt{H} & \texttt{O} & \texttt{L} & \texttt{D} & \texttt{T} & \texttt{H} & \texttt{E} & \texttt{S} & \texttt{E} & \texttt{T} & \texttt{R} & \texttt{U} & \texttt{T} \\

                          \texttt{H} & \texttt{S} & \texttt{T} & \texttt{O} & \texttt{B} & \texttt{E} & \texttt{S} & \texttt{E} & \texttt{L} & \texttt{F} & \texttt{E} & \texttt{V} & \texttt{I} & \texttt{D} & \texttt{E} \\

                          \texttt{N} & \texttt{T} & \texttt{T} & \texttt{H} & \texttt{A} & \texttt{T} & \texttt{A} & \texttt{L} & \texttt{L} & \texttt{M} & \texttt{E} & \texttt{N} & \texttt{A} & \texttt{R} & \texttt{E} \\

                          \texttt{C} & \texttt{R} & \texttt{E} & \texttt{A} & \texttt{T} & \texttt{E} & \texttt{D} & \texttt{E} & \texttt{Q} & \texttt{U} & \texttt{A} & \texttt{L} & \texttt{T} & \texttt{H} & \texttt{A}
                      \end{array}
                  \]
                  \vspace*{-1cm}
              \end{center}
              There we finally have our transcription! ``We hold these truths to be self-evident that all men are created equal tha\ldots'' (Declaration of Independence again).
    \end{enumerate}
}

\begin{exercise}
    {Additional Problem} Write down the steps for an algorithm to encrypt a plaintext using a transposition/Scytale cipher using \(n\) columns. \textit{Hint: This should involve some modular arithmetic.}
\end{exercise}

\sol{
    \begin{enumerate}[label=(\arabic*)]
        \item Remove all spaces from the plaintext message.
        \item Let \(i\) be the length of the message after removing spaces.
        \item Find the number of rows \(m\) required for the transposition cipher matrix:
              \[
                  m = \left\lceil \frac{i}{n} \right\rceil
              \]
        \item Create an \(m \times n\) matrix to hold the characters.
        \item For each character in the message, place it into the matrix. Let the index of the current character in the message be \(k\), where \(0 \leq k < i\). Calculate the row and column for this character as follows:
              \[
                  \text{row} = \left\lfloor \frac{k}{n} \right\rfloor
              \]
              \[
                  \text{column} = k \ (\text{mod } n)
              \]
        \item Once all characters are placed into the matrix, read the matrix column by column to form the ciphertext. For each column \(j\), loop through the rows and append each character to the ciphertext in the following order:
              \[
                  \text{character index} = j + n \times \text{row}
              \]
        \item If there are empty cells (i.e., \(n\) does not divide the message length \(i\)), fill these cells with random characters or leave them blank.
        \item Concatenate the characters column by column to form the final ciphertext.
    \end{enumerate}

}

\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumi}{\theenumi.}
\section{Symmetric and Antisymmetric Ciphers}

\subsection{Symmetric Ciphers}

\wrpdef{Symmetric Cipher}{A cipher that uses the same key for both encryption and decryption.}

\begin{center}
    \subsubsection{Review of Notation}
\end{center}

\begin{itemize}
    \item \(k\) implies \hyperref[Key]{key};
    \item \(\mathcal{K}\) implies \hyperref[Key Space]{key space};
    \item \(m\) implies plaintext \hyperref[Plain Text]{plain text};
    \item \(c\) implies \hyperref[Cipher Text]{cipher text};
    \item \(\mathcal{M}\) implies all possible messages (message space);
    \item \(\mathcal{C}\) implies all possible cipher texts (cipher space);
    \item Encryption is a function that is defined as: \[e: \mathcal{K} \times \mathcal{M} \rightarrow \mathcal{C} \text{ such that } d(k(e(k,m))) = m\]
    \item Decryption is a function that is defined as: \[d: \mathcal{K} \times \mathcal{C} \rightarrow \mathcal{M} \text{ such that } e(k,d(k,c)) = c\]
\end{itemize}

\subsection{Successful Ciphers}
\label{Successful Ciphers}

This brings us to what it means to be a \textit{successful} cipher. Thus, we look to \textit{Kerckhoff's Principle} which states that the security of a cipher should not depend on the secrecy of the algorithm, but rather on the secrecy of the key. Therefore, we have the following properties that are required for each cipher:
\begin{enumerate}[label=\arabic*.]
    \item For all \(k\) and \(m\), it is easy to compute \(e_k(m)\). (Note that \textit{easy} is relative to the computational power of the adversary. For this course, \textit{easy} denotes a decryption time of less than a second.)
    \item For all \(k\) and \(c\), it is easy to compute \(e_k(c)\).
    \item Given one or more ciphertext, \(c_1,\dots c_n\), all encrypted with the same key, it is hard to compute any plaintext, \(m\), such that \(d_k(m)\) without knowing the key.
\end{enumerate}

The next traits are desired, but not required:

\begin{enumerate}[label=\arabic*.]
    \setcounter{enumi}{3}
    \item Given one or more PT and CT pair, \((m_1,c_1),\dots,(m_n,c_n)\) it is decrypt another CT not on this list without knowing the key. An example would be the \textit{enigma cipher} from WW-II\@.
    \item For any PT chosen by the adversary and their CT's, \((c_1,\dots c_n)\), it should be hard to decrypt any CT not in this list.
\end{enumerate}

\begin{center}
    \subsubsection{Types of Attacks}
\end{center}

\begin{itemize}
    \item \textit{Brute Force Attack}: Trying all possible keys.
    \item \textit{Known PT Attack}: The adversary knows the plaintext and the corresponding ciphertext.
    \item \textit{Chosen PT Attack}: The adversary chooses the plaintext and receives the corresponding ciphertext.
\end{itemize}

\begin{center}
    \subsubsection{Types of Ciphers}
\end{center}

\begin{enumerate}[label=\arabic*.]
    \item Multiplication modulo \(m\): \(c = m \times k \ (\text{mod } m)\).
          \begin{itemize}
              \item \(\mathcal{K} = \mathcal{M} = \mathcal{C} = \F_p^*\)
              \item \(k \in \F_p^*\)
              \item \(e_k(m) = k \cdot m \ (\text{mod } p)\)
              \item \(d_k(m) = k^{-1} \cdot c \ (\text{mod } p)\)
              \item Example: \(\F_{307}, k = 258, m = 444, e_{258}(444) = 258.444 \ (\text{mod } 1307) = 843\). To find decrypt this message, Eve needs to iterate through \(1307 - 1\) different keys. (Easy.)
          \end{itemize}
    \item Add \((\text{mod } m)\): \(c = m + k \ (\text{mod } m)\). (Caesar Cipher.)
    \item Affine Cipher: Key \(= (k_1,k_2) \in \Z \times \Z\).
    \item Hill Cipher.
    \item Vernam's One-time Pad.
\end{enumerate}

\subsection{Encoding Schemes}

\begin{definition}
    {Encoding Scheme}An \textit{encoding scheme} is a method of converting plaintext into a form that can be transmitted over a channel. An encoding scheme is assumed to be entirely public knowledge and used by everyone for the same purposes. An encryption scheme is designed to hide information from anyone who dopes not know the key. Thus, an encoding scheme, like an encryption scheme, consists of an encoding functions are public knowledge and should be fast and easy to compute.
\end{definition}

This section will cover ASCII\@: We can take strings of 8 bits and convert them into a single character. From 0 to 255, and use them to represent the letters of the alphabet via \(\texttt{a} = 00000000, \texttt{b} = 00000001, \texttt{c} = 00000010, \dots, \texttt{z} = 00011001\). To distinguish between upper and lower case letters, we can use the first bit to represent the case.

\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand{\labelenumi}{(\theenumi)}
\subsection{Exercises}

\begin{exercise}
    {1.46}
    \begin{enumerate}
        \item Convert the 12-bit binary number \(110101100101\) into a decimal integer between \(0\) and \(2^{12} - 1\).
              \setcounter{enumi}{4}

        \item Convert the decimal numbers \(8734\) and \(5177\) into binary numbers, combine them using XOR, and convert the result back into a decimal number.
    \end{enumerate}
\end{exercise}
\vspace{1em}
For this exercise, I will be using these python functions that I wrote:
\begin{lstlisting}[language=Python,numbers=left]
def compute_binary(num):
    binary_representation = []
    while num != 0:
        result = num % 2
        num = num // 2
        binary_representation.append(result)
    binary_str = ''.join(map(str, binary_representation))
    print(binary_str)

def compute_decimal_int(binary_str):
    int_representation = int(binary_str, 2)
    print(int_representation)
\end{lstlisting}
% Note that this is just what \texttt{bin} does, but I am providing this function to show work for the problem. 

\sol{

    \begin{enumerate}
        \item 3429
              \setcounter{enumi}{4}
        \item Note the added 0 for the second binary number so the two numbers add properly.
              \begin{align*}
                  8734             & = 10001000011110 \\
                  5177             & = 01010000111001 \\
                  8734 \oplus 5177 & = 11011001010111 \\
                  13863            & = 11011001010111
              \end{align*}
    \end{enumerate}
}