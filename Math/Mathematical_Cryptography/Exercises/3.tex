\begin{exercise}
    {2.3} Let \(g\) be a \hyperlink{section 2.2}{primitive root} for \(\mathbb{F}_p\).
    \begin{enumerate}
        \setcounter{enumi}{1} % Start enumeration at (b)
        \item Prove that \(\log_g(h_1 h_2) = \log_g(h_1) + \log_g(h_2)\) for all \(h_1, h_2 \in \mathbb{F}_p^*\).
        \item Prove that \(\log_g(h^n) = n \log_g(h)\) for all \(h \in \mathbb{F}_p^*\) and \(n \in \mathbb{Z}\).
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \setcounter{enumi}{1}
        \item \textit{Proof.} We know that \(g^x \equiv h \pmod{p}\), which means that \(x = \log_g(h)\). Similarly, if \(g^{x_1} \equiv h_1 \pmod{p}\) and \(g^{x_2} \equiv h_2 \pmod{p}\), then \(x_1 = \log_g(h_1)\) and \(x_2 = \log(h_2)\). Now, we can substitute these values into the first equation to get \(g^{x_1 + x_2} \equiv h_1h_2 \pmod{p} \equiv g^{\log_g(h_1) + \log_g(h_2)} \pmod{p}\). Then, from the properties of exponents, we can rewrite this equation as \(h_1 \cdot h_2 \pmod{p} \equiv g^{\log_g(h_1h_2)} \pmod{p}\). Therefore, \(\log_g(h_1 \cdot h_2) = \log_g(h_1) + \log_g(h_2)\).
        \item \textit{Proof} Following a similar process to \((b)\), we start with \(g^{n\log_g(h)}\). Then, by using the properties of logarithms, we can rewrite this as \(g^{\log_g(h^n)}\). Then, because \(g^{\log_g}\) cancel out, we see that \(g^{\log_g(h^n)} = h^n\). Putting everything together, we have \begin{align*}
                  g^{\log_g(h^n)} & \equiv h^n \pmod{p}         \\
                  \log_g(h^n)     & \equiv n\log_g(h) \pmod{p}.
              \end{align*}
    \end{enumerate}
}

\begin{exercise}
    {2.4} Compute the following \hyperlink{section 2.3}{discrete logarithms}.
    \begin{enumerate}
        \item \(\log_2(13)\) for the prime \(23\), i.e., \(p = 23\), \(g = 2\), and you must solve the congruence \(2^x \equiv 13 \pmod{23}\).
        \item \(\log_{10}(22)\) for the prime \(p = 47\).
        \item \(\log_{627}(608)\) for the prime \(p = 941\). (Hint: Look in the second column of Table 2.1 on page 66.)
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item We use Wolfram Alpha to solve for \(x\) in the equation \(2^x \equiv 13 \pmod{23}\): \(x = 7\).
        \item Solving for \(x\) we get \(x = 11\).
        \item \(x = 18\).
    \end{enumerate}
}

\begin{exercise}
    {2.6} Alice and Bob agree to use the prime \(p = 1373\) and the base \(g = 2\) for a \hyperlink{d-h key}{Diffie-Hellman key exchange}. Alice sends Bob the value \(A = 974\). Bob asks for your assistance, so you tell him to use the secret exponent \(b = 871\).
    \begin{enumerate}
        \item What value \(B\) should Bob send to Alice, and what is their secret shared value?
        \item Can you figure out Alice's secret exponent?
    \end{enumerate}
\end{exercise}

\begin{center}
    \textbf{Added (a) and (b) for clarity in Exercise 2.6.}
\end{center}

\sol{
    \begin{enumerate}
        \item Bob sends \(B = g^b = 2^{871} \equiv 805 \pmod{1373}\). Their shared secret value is \(974^{871} \equiv 397 \pmod{1373}\) (via Wolfram Alpha).
        \item To get Alice's secret exponent, we need to solve \(a\) by brute force. Thus, we need to solve the equation \(2^a \equiv 974 \pmod{1373}\). We find that \(a = 587\).
    \end{enumerate}
}

\begin{exercise}
    {2.7} Let \(p\) be a prime and let \(g\) be an integer. The \textit{Decision Diffie-Hellman Problem} is as follows. Suppose that you are given three numbers \(A\), \(B\), and \(C\), and suppose that \(A\) and \(B\) are equal to
    \[
        A \equiv g^a \pmod{p} \quad \text{and} \quad B \equiv g^b \pmod{p},
    \]
    but that you do not necessarily know the values of the exponents \(a\) and \(b\). Determine whether \(C\) is equal to \(g^{ab} \pmod{p}\). Notice that this is different from the Diffie-Hellman problem described on page 69. The Diffie-Hellman problem asks you to actually compute the value of \(g^{ab}\).
    \begin{enumerate}
        \item Prove that an algorithm that solves the Diffie-Hellman problem can be used to solve the decision Diffie-Hellman problem.
        \item Do you think that the decision Diffie-Hellman problem is hard or easy? Why? See Exercise 6.40 for a related example in which the decision problem is easy, but it is believed that the associated computational problem is hard.
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item Since we know that \(A = g^a \pmod{p}\) and \(B = g^b \pmod{p}\), then we just have to compare \(C\) to \(g^{ab} \pmod{p}\). If \(C = g^{ab} \pmod{p}\), then the algorithm solves the decision Diffie-Hellman problem.
        \item Because we only know \(A\) and \(B\) it makes determining \(C\) hard because we only know \(g^{a+b}\) and \textit{not} \(g^{ab}\). Thus, the decision Diffie-Hellman problem is hard because it is difficult to determine whether \(C = g^{ab} \pmod{p}\) without knowing \(a\) and \(b\).
    \end{enumerate}
}

\begin{exercise}
    {2.8} Alice and Bob agree to use the prime \(p = 1373\) and the base \(g = 2\) for communications using the \hyperlink{Elgamal}{Elgamal public key cryptosystem}.
    \begin{enumerate}
        \item Alice chooses \(a = 947\) as her private key. What is the value of her public key \(A\)?
        \item Bob chooses \(b = 716\) as his private key, so his public key is
              \[
                  B \equiv 2^{716} \equiv 469 \pmod{1373}.
              \]
              Alice encrypts the message \(m = 583\) using the random element \(k = 877\). What is the ciphertext \((c_1, c_2)\) that Alice sends to Bob?
        \item Alice decides to choose a new private key \(a = 299\) with associated public key
              \[
                  A \equiv 2^{299} \equiv 34 \pmod{1373}.
              \]
              Bob encrypts a message using Alice's public key and sends her the ciphertext \((c_1, c_2) = (661, 1325)\). Decrypt the message.
        \item Now Bob chooses a new private key and publishes the associated public key \(B = 893\). Alice encrypts a message using this public key and sends the ciphertext \((c_1, c_2) = (693, 793)\) to Bob. Eve intercepts the transmission. Help Eve by solving the discrete logarithm problem \(2^b \equiv 893 \pmod{1373}\) and using the value of \(b\) to decrypt the message.
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item \(p = 1373, \ g = 2, \ a = 947 \Rightarrow A \equiv 2^{947} \pmod{1373} \equiv 177\).
        \item \(c_1 \equiv 2^{877} \pmod{1373} \equiv 719, \ c_2 \equiv 583 \cdot 469^{877} \pmod{1373} \equiv 623\). Alice sends ``\((719, 623)\)'' to Bob.
        \item To decrypt, we can use the \hyperlink{thm:Extended Euclidean Algorithm}{EEA} to find the inverse of \(661^{299} \pmod{1373} \equiv 645^{-1} \equiv 794\). From here, we solve for the message: \(1325 \cdot 794 \pmod{1373} \equiv 332\).
        \item Solving for \(b\) in \(2^b \equiv 893 \pmod{1373}\) gives \(b = 219\). Now we can decrypt:
              \[
                  (c_1^a)^{-1} \cdot c_2 \equiv (693^{219})^{-1} \equiv 431^{-1} \cdot 793 \equiv 532 \cdot 793 \equiv 365 \pmod{1373}.
              \] Alice's private message to Bob is \(m = 365\).
    \end{enumerate}
}

\begin{exercise}
    {1.46}
    \begin{enumerate}
        \item Convert the 12-bit binary number \(110101100101\) into a decimal integer between \(0\) and \(2^{12} - 1\).
              \setcounter{enumi}{4}

        \item Convert the decimal numbers \(8734\) and \(5177\) into binary numbers, combine them using XOR, and convert the result back into a decimal number.
    \end{enumerate}
\end{exercise}

For this exercise, I will be using these python functions that I wrote:
\begin{lstlisting}[language=python]
    def compute_binary(num):
        binary_representation = []
        while num != 0:
            result = num % 2
            num = num // 2
            binary_representation.append(result)
        binary_str = ''.join(map(str, binary_representation))
        print(binary_str)

    def compute_decimal_int(binary_str):
        int_representation = int(binary_str, 2)
        print(int_representation)
\end{lstlisting}
% Note that this is just what \texttt{bin} does, but I am providing this function to show work for the problem. 

\sol{

    \begin{enumerate}
        \item 3429
              \setcounter{enumi}{4}
        \item Note the added 0 for the second binary number so the two numbers add properly.
              \begin{align*}
                  8734             & = 10001000011110 \\
                  5177             & = 01010000111001 \\
                  8734 \oplus 5177 & = 11011001010111 \\
                  13863            & = 11011001010111
              \end{align*}
    \end{enumerate}
}

\begin{exercise}
    {2.17} Use \hyperlink{2.21}{Shanks's babystep-giantstep} method to solve the following discrete logarithm problems.
    \begin{enumerate}
        \item \(11^x = 21\) in \(\mathbb{F}_{71}\).
    \end{enumerate}
\end{exercise}

\sol{
    \begin{enumerate}
        \item \begin{enumerate}[label=\arabic*.]
                  \item Let \(m = \lceil \sqrt{70} \rceil = 9\)
                  \item Create two lists: \begin{itemize}
                            \item \textbf{Baby steps:} \[\{11^0, 11^1,\dots,11^9\} \pmod{71} \equiv \{1, \boxed{11}, 50, 53, 15, 23, 40, 14, 12\}\]
                            \item \textbf{Giant steps:} \[\{21, 21 \cdot 11^{-9}, 21 \cdot 11^{-18}, \dots\} \pmod{71} \equiv \{21, 5, 35, 32, \boxed{11}\dots\}\]
                        \end{itemize}
                  \item Find a match between the two lists: \(\boxed{11}\)
                  \item Substitute values for \(i + jm = 1 + 4(9) = 37\). So, \(11^{37} \equiv 21 \pmod{71}\)
              \end{enumerate}
    \end{enumerate}
}

\begin{exercise}
    {2.18} Solve each of the following simultaneous systems of congruences (or explain why no solution exists).
    \begin{enumerate}
        \setcounter{enumi}{1} % Start enumeration at (b)
        \item \(x \equiv 137 \pmod{423}\) and \(x \equiv 87 \pmod{191}\).
              \setcounter{enumi}{3} % Start enumeration at (d)
        \item \(x \equiv 5 \pmod{9}\), \(x \equiv 6 \pmod{10}\), and \(x \equiv 7 \pmod{11}\).
    \end{enumerate}
\end{exercise}

%%
% Variables
% m_1 = 423
% m_2 = 191
% m = 80793
% n_1 = 191
% n_2 = 423
% a_1 = 137
% a_2 = 87
%%


\sol{
    \begin{enumerate}
        \setcounter{enumi}{1}
        \item \begin{enumerate}[label=\arabic*.]
                  \item Let \(m = 423 \cdot 191 = 80793\).
                  \item Compute \(n_1 = \frac{m}{m_1} = \frac{80793}{423} = 191\), and \(n_2 = \frac{80793}{191} = 423\)
                  \item Compute \(y_1 = 191^{-1} \pmod{423} \equiv 392\) and \(y_2 = 423^{-1} \pmod{191} \equiv 14\).
                  \item Compute \(x = (137)(191)(392) + (87)(423)(14) \pmod{80793} \equiv 27209\)
              \end{enumerate}
              \setcounter{enumi}{3} % Start enumeration at (d)
        \item \begin{enumerate}[label=\arabic*.]
                  \item Let \(m = 9 \cdot 10 \cdot 11 = 990\).
                  \item Compute \(n_1 = \frac{990}{9} = 110, \ n_2 = \frac{990}{10} = 99, \text{ and } n_3 = \frac{990}{11} = 90\).
                  \item Compute \(y_1 = 110^{-1} \pmod{9} \equiv 5, \ y_2 = 99^{-1} \pmod{10} \equiv 9\), and \(y_3 = 90^{-1} \pmod{11} \equiv 6\)
                  \item Compute \(x = (5)(110)(5) + (6)(99)(9) + (7)(90)(6) \pmod{990} = 986\)
              \end{enumerate}

    \end{enumerate}
}

\begin{exercise}
    {2.20}Let \( a, b, m, n \) be integers with \( \gcd(m, n) = 1 \). Let
    \[
        c \equiv (b - a) \cdot m^{-1} \pmod{n}.
    \]
    Prove that \( x = a + cm \) is a solution to
    \[
        x \equiv a \pmod{m} \quad \text{and} \quad x \equiv b \pmod{n}, \tag{2.24}
    \]
    and that every solution to (2.24) has the form \( x = a + cm + ymn \) for some \( y \in \mathbb{Z} \).
\end{exercise}

\expf{
Let \(a,b,m,n \in \Z\) with \(\gcd(m,n) = 1\). Let \(c \equiv (b - a)m^{-1} \pmod{n}\). Review the following: \begin{align*}
    x      & \equiv a \pmod{m}       \\
    a + cm & \equiv a \pmod{m}       \\
    a      & \equiv a \pmod{m} - cm.
\end{align*} Then, because \(cm\) is a multiple of \(m\), when we take the mod of \(a - cm \pmod{m}\), we will always get \(a\). Hence, \(a \equiv a \pmod{m}\). For the other equation, we will be using the def of \(c\) in our proof: \begin{align*}
    a + cm & \equiv b \pmod{n}             \\
    cm     & \equiv b - a \pmod{n}         \\
    c      & \equiv (b - a)m^{-1}\pmod{n}.
\end{align*} So, now when we multiply by \(m\) on both sides, we get \(cm \equiv b - a \pmod{n}\). Rearranging, we see \(cm + a \equiv b \pmod{n}\), so \(x\) is a solution.

For the second half of the proof, suppose we have \(x'\) as the solution for \(x' \equiv a \pmod{m}\) and \(x' \equiv b \pmod{n}\). We want to show that \(x' = x\). Thus, we subtract \(x\) from \(x'\) and get the following: \[
    x' - x \equiv a - a = 0 \pmod{m}, \text{ which implies } x' - x = km \text{ for some } k \in \Z.
\] This is the outcome because we know that for anything to be equal to 0 in modulus, the number itself must be a multiple of the modulus, \(m\). We can follow the same logic for \(b\), and see that \(x' - x \equiv b - b = lm\) for some \(l \in \Z\). Since \(\gcd(m,n) = 1\), \(x' - x\) must be a multiple of \(m\) and \(n\), meaning \(x' - x = ymn\) for some \(y \in \Z\). Therefore, \(x' = x + ymn, = a + cm + ymn\).
}

\begin{exercise}
    {2.28} Use the \hyperlink{Pohlig-Hellman}{Pohlig-Hellman algorithm} (Theorem 2.31) to solve the discrete logarithm problem \(g^x = a\) in \(\mathbb{F}_p\) in each of the following cases.
    \begin{enumerate}
        \item \(p = 433\), \(g = 7\), \(a = 166\).
    \end{enumerate}
\end{exercise}

\sol{
    We start by writing the given information into an equation that we can work with. Thus, \(7^x \equiv 166 \pmod{433}\). Since \(433\) is prime, \(\varphi(433) = 432\), which we can factor to \(16 \cdot 27\). Let \(x = a_0 + 16a_1\):
    \begin{align}
        (7^{a_0 + 16a_1})^{27}        & \equiv 166^{27} \pmod{433} \\
        (7^{27a_0 + 432a_1})          & \equiv                     \\
        (7^{27a_0} \cdot 7^{432a_1})  & \equiv                     \\
        (7^{27})^{a_0}(7^{a_1})^{432} & \equiv                     \\
        (265)^{a_0}                   & \equiv 250 \pmod{433}
    \end{align}
    For (3.1), we got the expression by substituting \(x\) for \(a_0 + 16a_1\) for the exponent in \(g^x \equiv \dots\). From there, (3.2) --- (3.4) is simple algebra. Then for (3.5), because \(7^{a_1}\) is congruent to 1, \((7^{a_1})^{432} = 1\). Additionally, we take \(7^{27} \pmod{432}\) to get \(265^{a_0}\). Then, we do the same thing for the other side of the equation. Now, we can brute force this by setting \(a_1 = \{0,1,2,3,\dots, 27\}\). We find that when \(a_0 = 15\), \(265^{a_0} \equiv 250 \pmod{433}\). Seeing that we have \(a_0\), we need to find \(b_0\):
    \begin{align*}
        (7^{b_0 + 27b_1})^{16} & \equiv 166^{16} \pmod{433} \\
        374^{b_0}              & \equiv 335 \pmod{433}
    \end{align*}
    Thus, through brute force, we find that \(b_0 = 20\). We can take our \(a_0\) and \(b_0\) to solve for \(x_1,x_2\):
    \begin{align*}
        x_1 & =  a_0 + 16a_1 \\
        x_1 & = 15 \pmod{16}
    \end{align*} and \begin{align*}
        x_2 & = b_0 + 27b_1  \\
        x_2 & = 20 \pmod{27}
    \end{align*}
    At this point, we can solve the \hyperlink{thm:Chinese Remainder}{CRT}.
    \begin{enumerate}[label=\arabic*.]
        \item Let \(m = 16 \cdot 27 = 432\).
        \item Compute \(n_1 = \frac{432}{16} = 27\) and \(n_2 = \frac{432}{27} = 16\).
        \item Compute \(y_1 = 27^{-1} \pmod{16} \equiv 3\) and \(y_2 = 16^{-1} \pmod{27} \equiv 22\).
        \item Compute \(x = (27)(15)(3) + (20)(16)(22) \pmod{432} = 47\)
    \end{enumerate} I relied on \href{https://www.youtube.com/watch?v=CHfP5tBbiAg}{this video} heavily.
}

